<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Section 4 Working with lists and iteration | TRES Tidyverse Tutorial</title>
  <meta name="description" content="Section 4 Working with lists and iteration | TRES Tidyverse Tutorial" />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="Section 4 Working with lists and iteration | TRES Tidyverse Tutorial" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Section 4 Working with lists and iteration | TRES Tidyverse Tutorial" />
  <meta name="github-repo" content="pratikunterwegs/tres-tidy-tutorial" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Section 4 Working with lists and iteration | TRES Tidyverse Tutorial" />
  
  <meta name="twitter:description" content="Section 4 Working with lists and iteration | TRES Tidyverse Tutorial" />
  

<meta name="author" content="Raphael, Pratik and Theo" />


<meta name="date" content="2020-06-05" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data-manipulation-with-dplyr.html"/>

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Outline</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#about"><i class="fa fa-check"></i>About</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#schedule"><i class="fa fa-check"></i>Schedule</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#possible-extras"><i class="fa fa-check"></i>Possible extras</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#join"><i class="fa fa-check"></i>Join</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="reading-files-and-string-manipulation.html"><a href="reading-files-and-string-manipulation.html"><i class="fa fa-check"></i><b>1</b> Reading files and string manipulation</a><ul>
<li class="chapter" data-level="1.1" data-path="reading-files-and-string-manipulation.html"><a href="reading-files-and-string-manipulation.html#data-import-and-export-with-readr"><i class="fa fa-check"></i><b>1.1</b> Data import and export with <code>readr</code></a><ul>
<li class="chapter" data-level="1.1.1" data-path="reading-files-and-string-manipulation.html"><a href="reading-files-and-string-manipulation.html#reading-data"><i class="fa fa-check"></i><b>1.1.1</b> Reading data</a></li>
<li class="chapter" data-level="1.1.2" data-path="reading-files-and-string-manipulation.html"><a href="reading-files-and-string-manipulation.html#writing-data"><i class="fa fa-check"></i><b>1.1.2</b> Writing data</a></li>
<li class="chapter" data-level="1.1.3" data-path="reading-files-and-string-manipulation.html"><a href="reading-files-and-string-manipulation.html#reading-and-writing-lines"><i class="fa fa-check"></i><b>1.1.3</b> Reading and writing lines</a></li>
<li class="chapter" data-level="" data-path="reading-files-and-string-manipulation.html"><a href="reading-files-and-string-manipulation.html#excel-files"><i class="fa fa-check"></i>Excel files</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="reading-files-and-string-manipulation.html"><a href="reading-files-and-string-manipulation.html#string-manipulation-with-stringr"><i class="fa fa-check"></i><b>1.2</b> String manipulation with <code>stringr</code></a><ul>
<li class="chapter" data-level="1.2.1" data-path="reading-files-and-string-manipulation.html"><a href="reading-files-and-string-manipulation.html#putting-strings-together"><i class="fa fa-check"></i><b>1.2.1</b> Putting strings together</a></li>
<li class="chapter" data-level="1.2.2" data-path="reading-files-and-string-manipulation.html"><a href="reading-files-and-string-manipulation.html#detecting-strings"><i class="fa fa-check"></i><b>1.2.2</b> Detecting strings</a></li>
<li class="chapter" data-level="1.2.3" data-path="reading-files-and-string-manipulation.html"><a href="reading-files-and-string-manipulation.html#matching-strings"><i class="fa fa-check"></i><b>1.2.3</b> Matching strings</a></li>
<li class="chapter" data-level="1.2.4" data-path="reading-files-and-string-manipulation.html"><a href="reading-files-and-string-manipulation.html#simpler-pattern-extraction"><i class="fa fa-check"></i><b>1.2.4</b> Simpler pattern extraction</a></li>
<li class="chapter" data-level="1.2.5" data-path="reading-files-and-string-manipulation.html"><a href="reading-files-and-string-manipulation.html#breaking-strings-apart"><i class="fa fa-check"></i><b>1.2.5</b> Breaking strings apart</a></li>
<li class="chapter" data-level="1.2.6" data-path="reading-files-and-string-manipulation.html"><a href="reading-files-and-string-manipulation.html#replacing-string-elements"><i class="fa fa-check"></i><b>1.2.6</b> Replacing string elements</a></li>
<li class="chapter" data-level="1.2.7" data-path="reading-files-and-string-manipulation.html"><a href="reading-files-and-string-manipulation.html#subsetting-within-strings"><i class="fa fa-check"></i><b>1.2.7</b> Subsetting within strings</a></li>
<li class="chapter" data-level="1.2.8" data-path="reading-files-and-string-manipulation.html"><a href="reading-files-and-string-manipulation.html#padding-and-truncating-strings"><i class="fa fa-check"></i><b>1.2.8</b> Padding and truncating strings</a></li>
<li class="chapter" data-level="1.2.9" data-path="reading-files-and-string-manipulation.html"><a href="reading-files-and-string-manipulation.html#stringr-aspects-not-covered-here"><i class="fa fa-check"></i><b>1.2.9</b> Stringr aspects not covered here</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="reading-files-and-string-manipulation.html"><a href="reading-files-and-string-manipulation.html#string-interpolation-with-glue"><i class="fa fa-check"></i><b>1.3</b> String interpolation with <code>glue</code></a></li>
<li class="chapter" data-level="1.4" data-path="reading-files-and-string-manipulation.html"><a href="reading-files-and-string-manipulation.html#strings-in-ggplot"><i class="fa fa-check"></i><b>1.4</b> Strings in <code>ggplot</code></a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="reshaping-data-tables-in-the-tidyverse-and-other-things.html"><a href="reshaping-data-tables-in-the-tidyverse-and-other-things.html"><i class="fa fa-check"></i><b>2</b> Reshaping data tables in the tidyverse, and other things</a><ul>
<li class="chapter" data-level="2.1" data-path="reshaping-data-tables-in-the-tidyverse-and-other-things.html"><a href="reshaping-data-tables-in-the-tidyverse-and-other-things.html#the-new-data-frame-tibble"><i class="fa fa-check"></i><b>2.1</b> The new data frame: tibble</a></li>
<li class="chapter" data-level="2.2" data-path="reshaping-data-tables-in-the-tidyverse-and-other-things.html"><a href="reshaping-data-tables-in-the-tidyverse-and-other-things.html#the-concept-of-tidy-data"><i class="fa fa-check"></i><b>2.2</b> The concept of tidy data</a></li>
<li class="chapter" data-level="2.3" data-path="reshaping-data-tables-in-the-tidyverse-and-other-things.html"><a href="reshaping-data-tables-in-the-tidyverse-and-other-things.html#reshaping-with-tidyr"><i class="fa fa-check"></i><b>2.3</b> Reshaping with <code>tidyr</code></a><ul>
<li class="chapter" data-level="2.3.1" data-path="reshaping-data-tables-in-the-tidyverse-and-other-things.html"><a href="reshaping-data-tables-in-the-tidyverse-and-other-things.html#pivoting"><i class="fa fa-check"></i><b>2.3.1</b> Pivoting</a></li>
<li class="chapter" data-level="2.3.2" data-path="reshaping-data-tables-in-the-tidyverse-and-other-things.html"><a href="reshaping-data-tables-in-the-tidyverse-and-other-things.html#handling-missing-values"><i class="fa fa-check"></i><b>2.3.2</b> Handling missing values</a></li>
<li class="chapter" data-level="2.3.3" data-path="reshaping-data-tables-in-the-tidyverse-and-other-things.html"><a href="reshaping-data-tables-in-the-tidyverse-and-other-things.html#splitting-and-combining-cells"><i class="fa fa-check"></i><b>2.3.3</b> Splitting and combining cells</a></li>
<li class="chapter" data-level="2.3.4" data-path="reshaping-data-tables-in-the-tidyverse-and-other-things.html"><a href="reshaping-data-tables-in-the-tidyverse-and-other-things.html#expanding-tables-using-combinations"><i class="fa fa-check"></i><b>2.3.4</b> Expanding tables using combinations</a></li>
<li class="chapter" data-level="2.3.5" data-path="reshaping-data-tables-in-the-tidyverse-and-other-things.html"><a href="reshaping-data-tables-in-the-tidyverse-and-other-things.html#nesting"><i class="fa fa-check"></i><b>2.3.5</b> Nesting</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="reshaping-data-tables-in-the-tidyverse-and-other-things.html"><a href="reshaping-data-tables-in-the-tidyverse-and-other-things.html#extra-factors-and-the-forcats-package"><i class="fa fa-check"></i><b>2.4</b> Extra: factors and the <code>forcats</code> package</a><ul>
<li class="chapter" data-level="2.4.1" data-path="reshaping-data-tables-in-the-tidyverse-and-other-things.html"><a href="reshaping-data-tables-in-the-tidyverse-and-other-things.html#change-the-order-of-the-levels"><i class="fa fa-check"></i><b>2.4.1</b> Change the order of the levels</a></li>
<li class="chapter" data-level="2.4.2" data-path="reshaping-data-tables-in-the-tidyverse-and-other-things.html"><a href="reshaping-data-tables-in-the-tidyverse-and-other-things.html#change-the-levels-themselves"><i class="fa fa-check"></i><b>2.4.2</b> Change the levels themselves</a></li>
<li class="chapter" data-level="2.4.3" data-path="reshaping-data-tables-in-the-tidyverse-and-other-things.html"><a href="reshaping-data-tables-in-the-tidyverse-and-other-things.html#dropping-levels"><i class="fa fa-check"></i><b>2.4.3</b> Dropping levels</a></li>
<li class="chapter" data-level="2.4.4" data-path="reshaping-data-tables-in-the-tidyverse-and-other-things.html"><a href="reshaping-data-tables-in-the-tidyverse-and-other-things.html#other-things"><i class="fa fa-check"></i><b>2.4.4</b> Other things</a></li>
<li class="chapter" data-level="2.4.5" data-path="reshaping-data-tables-in-the-tidyverse-and-other-things.html"><a href="reshaping-data-tables-in-the-tidyverse-and-other-things.html#take-home-message-for-forcats"><i class="fa fa-check"></i><b>2.4.5</b> Take home message for forcats</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="reshaping-data-tables-in-the-tidyverse-and-other-things.html"><a href="reshaping-data-tables-in-the-tidyverse-and-other-things.html#external-resources"><i class="fa fa-check"></i><b>2.5</b> External resources</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-manipulation-with-dplyr.html"><a href="data-manipulation-with-dplyr.html"><i class="fa fa-check"></i><b>3</b> Data manipulation with <code>dplyr</code></a><ul>
<li class="chapter" data-level="3.1" data-path="data-manipulation-with-dplyr.html"><a href="data-manipulation-with-dplyr.html#introduction"><i class="fa fa-check"></i><b>3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2" data-path="data-manipulation-with-dplyr.html"><a href="data-manipulation-with-dplyr.html#example-data-of-the-day"><i class="fa fa-check"></i><b>3.2</b> Example data of the day</a></li>
<li class="chapter" data-level="3.3" data-path="data-manipulation-with-dplyr.html"><a href="data-manipulation-with-dplyr.html#select-variables-with-select"><i class="fa fa-check"></i><b>3.3</b> Select variables with <code>select()</code></a></li>
<li class="chapter" data-level="3.4" data-path="data-manipulation-with-dplyr.html"><a href="data-manipulation-with-dplyr.html#select-observations-with-filter"><i class="fa fa-check"></i><b>3.4</b> Select observations with <code>filter()</code></a></li>
<li class="chapter" data-level="3.5" data-path="data-manipulation-with-dplyr.html"><a href="data-manipulation-with-dplyr.html#create-new-variables-with-mutate"><i class="fa fa-check"></i><b>3.5</b> Create new variables with <code>mutate()</code></a></li>
<li class="chapter" data-level="3.6" data-path="data-manipulation-with-dplyr.html"><a href="data-manipulation-with-dplyr.html#grouped-results-with-group_by-and-summarise"><i class="fa fa-check"></i><b>3.6</b> Grouped results with <code>group_by()</code> and <code>summarise()</code></a></li>
<li class="chapter" data-level="3.7" data-path="data-manipulation-with-dplyr.html"><a href="data-manipulation-with-dplyr.html#scoped-variables"><i class="fa fa-check"></i><b>3.7</b> Scoped variables</a></li>
<li class="chapter" data-level="3.8" data-path="data-manipulation-with-dplyr.html"><a href="data-manipulation-with-dplyr.html#more"><i class="fa fa-check"></i><b>3.8</b> More !</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="working-with-lists-and-iteration.html"><a href="working-with-lists-and-iteration.html"><i class="fa fa-check"></i><b>4</b> Working with lists and iteration</a><ul>
<li class="chapter" data-level="4.1" data-path="working-with-lists-and-iteration.html"><a href="working-with-lists-and-iteration.html#iteration-with-map"><i class="fa fa-check"></i><b>4.1</b> Iteration with <code>map</code></a><ul>
<li class="chapter" data-level="4.1.1" data-path="working-with-lists-and-iteration.html"><a href="working-with-lists-and-iteration.html#basic-use-of-map"><i class="fa fa-check"></i><b>4.1.1</b> Basic use of <code>map</code></a></li>
<li class="chapter" data-level="4.1.2" data-path="working-with-lists-and-iteration.html"><a href="working-with-lists-and-iteration.html#map-variants-returning-vectors"><i class="fa fa-check"></i><b>4.1.2</b> <code>map</code> variants returning vectors</a></li>
<li class="chapter" data-level="4.1.3" data-path="working-with-lists-and-iteration.html"><a href="working-with-lists-and-iteration.html#integrating-map-and-tidyrnest"><i class="fa fa-check"></i><b>4.1.3</b> Integrating <code>map</code> and <code>tidyr::nest</code></a></li>
<li class="chapter" data-level="4.1.4" data-path="working-with-lists-and-iteration.html"><a href="working-with-lists-and-iteration.html#map-variants-returning-dataframes"><i class="fa fa-check"></i><b>4.1.4</b> <code>map</code> variants returning dataframes</a></li>
<li class="chapter" data-level="4.1.5" data-path="working-with-lists-and-iteration.html"><a href="working-with-lists-and-iteration.html#selective-mapping"><i class="fa fa-check"></i><b>4.1.5</b> Selective mapping</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="working-with-lists-and-iteration.html"><a href="working-with-lists-and-iteration.html#more-map-variants"><i class="fa fa-check"></i><b>4.2</b> More <code>map</code> variants</a><ul>
<li class="chapter" data-level="4.2.1" data-path="working-with-lists-and-iteration.html"><a href="working-with-lists-and-iteration.html#mapping-over-two-inputs-with-map2"><i class="fa fa-check"></i><b>4.2.1</b> Mapping over two inputs with map2</a></li>
<li class="chapter" data-level="4.2.2" data-path="working-with-lists-and-iteration.html"><a href="working-with-lists-and-iteration.html#mapping-over-multiple-inputs-with-pmap"><i class="fa fa-check"></i><b>4.2.2</b> Mapping over multiple inputs with pmap</a></li>
<li class="chapter" data-level="4.2.3" data-path="working-with-lists-and-iteration.html"><a href="working-with-lists-and-iteration.html#mapping-at-depth"><i class="fa fa-check"></i><b>4.2.3</b> Mapping at depth</a></li>
<li class="chapter" data-level="4.2.4" data-path="working-with-lists-and-iteration.html"><a href="working-with-lists-and-iteration.html#iteration-without-a-return"><i class="fa fa-check"></i><b>4.2.4</b> Iteration without a return</a></li>
<li class="chapter" data-level="4.2.5" data-path="working-with-lists-and-iteration.html"><a href="working-with-lists-and-iteration.html#modify-rather-than-map"><i class="fa fa-check"></i><b>4.2.5</b> Modify rather than map</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="working-with-lists-and-iteration.html"><a href="working-with-lists-and-iteration.html#working-with-lists"><i class="fa fa-check"></i><b>4.3</b> Working with lists</a><ul>
<li class="chapter" data-level="4.3.1" data-path="working-with-lists-and-iteration.html"><a href="working-with-lists-and-iteration.html#filtering-lists"><i class="fa fa-check"></i><b>4.3.1</b> Filtering lists</a></li>
<li class="chapter" data-level="4.3.2" data-path="working-with-lists-and-iteration.html"><a href="working-with-lists-and-iteration.html#summarising-lists"><i class="fa fa-check"></i><b>4.3.2</b> Summarising lists</a></li>
<li class="chapter" data-level="4.3.3" data-path="working-with-lists-and-iteration.html"><a href="working-with-lists-and-iteration.html#reduction-and-accumulation"><i class="fa fa-check"></i><b>4.3.3</b> Reduction and accumulation</a></li>
<li class="chapter" data-level="4.3.4" data-path="working-with-lists-and-iteration.html"><a href="working-with-lists-and-iteration.html#miscellaneous-operation"><i class="fa fa-check"></i><b>4.3.4</b> Miscellaneous operation</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">TRES Tidyverse Tutorial</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="working-with-lists-and-iteration" class="section level1">
<h1><span class="header-section-number">Section 4</span> Working with lists and iteration</h1>
<p><img src="opening-image.png" /></p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb76-1" title="1"><span class="co"># load the tidyverse</span></a>
<a class="sourceLine" id="cb76-2" title="2"><span class="kw">library</span>(tidyverse)</a></code></pre></div>
<div id="iteration-with-map" class="section level2">
<h2><span class="header-section-number">4.1</span> Iteration with <code>map</code></h2>
<p>Iteration in base <code>R</code> is commonly done with <code>for</code> and <code>while</code> loops.
There is no readymade alternative to <code>while</code> loops in the tidyverse.
However, the functionality of <code>for</code> loops is spread over the <code>map</code> family of functions from <code>purrr</code>.</p>
<p><code>purrr</code> functions are <em>functionals</em>, i.e., functions that take another function as an argument.
The closest equivalent in <code>R</code> is the <code>*apply</code> family of functions: <code>apply</code>, <code>lapply</code>, <code>vapply</code> and so on.</p>
<p>A good reason to use <code>purrr</code> functions instead of base <code>R</code> functions is their consistent and clear naming, which always indicates how they should be used.
This is explained in the examples below.</p>
<p>These reasons, as well as how <code>map</code> is different from <code>for</code> and <code>lapply</code> are best explained in the <strong><a href="https://adv-r.hadley.nz/functionals.html">Advanced R Book</a></strong>.</p>
<div id="basic-use-of-map" class="section level3">
<h3><span class="header-section-number">4.1.1</span> Basic use of <code>map</code></h3>
<p><code>map</code> works on any list-like object, which includes vectors, and always returns a list. <code>map</code> takes two arguments, the object on which to operate, and the function to apply to each element.</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb77-1" title="1"><span class="co"># get the square root of each integer 1 - 10</span></a>
<a class="sourceLine" id="cb77-2" title="2">some_numbers =<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">10</span></a>
<a class="sourceLine" id="cb77-3" title="3"><span class="kw">map</span>(some_numbers, sqrt)</a>
<a class="sourceLine" id="cb77-4" title="4"><span class="co">#&gt; [[1]]</span></a>
<a class="sourceLine" id="cb77-5" title="5"><span class="co">#&gt; [1] 1</span></a>
<a class="sourceLine" id="cb77-6" title="6"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb77-7" title="7"><span class="co">#&gt; [[2]]</span></a>
<a class="sourceLine" id="cb77-8" title="8"><span class="co">#&gt; [1] 1.41</span></a>
<a class="sourceLine" id="cb77-9" title="9"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb77-10" title="10"><span class="co">#&gt; [[3]]</span></a>
<a class="sourceLine" id="cb77-11" title="11"><span class="co">#&gt; [1] 1.73</span></a>
<a class="sourceLine" id="cb77-12" title="12"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb77-13" title="13"><span class="co">#&gt; [[4]]</span></a>
<a class="sourceLine" id="cb77-14" title="14"><span class="co">#&gt; [1] 2</span></a>
<a class="sourceLine" id="cb77-15" title="15"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb77-16" title="16"><span class="co">#&gt; [[5]]</span></a>
<a class="sourceLine" id="cb77-17" title="17"><span class="co">#&gt; [1] 2.24</span></a>
<a class="sourceLine" id="cb77-18" title="18"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb77-19" title="19"><span class="co">#&gt; [[6]]</span></a>
<a class="sourceLine" id="cb77-20" title="20"><span class="co">#&gt; [1] 2.45</span></a>
<a class="sourceLine" id="cb77-21" title="21"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb77-22" title="22"><span class="co">#&gt; [[7]]</span></a>
<a class="sourceLine" id="cb77-23" title="23"><span class="co">#&gt; [1] 2.65</span></a>
<a class="sourceLine" id="cb77-24" title="24"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb77-25" title="25"><span class="co">#&gt; [[8]]</span></a>
<a class="sourceLine" id="cb77-26" title="26"><span class="co">#&gt; [1] 2.83</span></a>
<a class="sourceLine" id="cb77-27" title="27"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb77-28" title="28"><span class="co">#&gt; [[9]]</span></a>
<a class="sourceLine" id="cb77-29" title="29"><span class="co">#&gt; [1] 3</span></a>
<a class="sourceLine" id="cb77-30" title="30"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb77-31" title="31"><span class="co">#&gt; [[10]]</span></a>
<a class="sourceLine" id="cb77-32" title="32"><span class="co">#&gt; [1] 3.16</span></a></code></pre></div>
</div>
<div id="map-variants-returning-vectors" class="section level3">
<h3><span class="header-section-number">4.1.2</span> <code>map</code> variants returning vectors</h3>
<p>Though <code>map</code> always returns a list, it has variants named <code>map_*</code> where the suffix indicates the return type.
<code>map_chr</code>, <code>map_dbl</code>, <code>map_int</code>, and <code>map_lgl</code> return character, double (numeric), integer, and logical vectors.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb78-1" title="1"><span class="co"># use map_dbl to get a vector of square roots</span></a>
<a class="sourceLine" id="cb78-2" title="2">some_numbers =<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">10</span></a>
<a class="sourceLine" id="cb78-3" title="3"><span class="kw">map_dbl</span>(some_numbers, sqrt)</a>
<a class="sourceLine" id="cb78-4" title="4"><span class="co">#&gt;  [1] 1.00 1.41 1.73 2.00 2.24 2.45 2.65 2.83 3.00 3.16</span></a>
<a class="sourceLine" id="cb78-5" title="5"></a>
<a class="sourceLine" id="cb78-6" title="6"><span class="co"># map_chr will convert the output to a character</span></a>
<a class="sourceLine" id="cb78-7" title="7"><span class="kw">map_chr</span>(some_numbers, sqrt)</a>
<a class="sourceLine" id="cb78-8" title="8"><span class="co">#&gt;  [1] &quot;1.000000&quot; &quot;1.414214&quot; &quot;1.732051&quot; &quot;2.000000&quot; &quot;2.236068&quot; &quot;2.449490&quot;</span></a>
<a class="sourceLine" id="cb78-9" title="9"><span class="co">#&gt;  [7] &quot;2.645751&quot; &quot;2.828427&quot; &quot;3.000000&quot; &quot;3.162278&quot;</span></a>
<a class="sourceLine" id="cb78-10" title="10"></a>
<a class="sourceLine" id="cb78-11" title="11"><span class="co"># map_int will NOT round the output to an integer</span></a>
<a class="sourceLine" id="cb78-12" title="12"></a>
<a class="sourceLine" id="cb78-13" title="13"><span class="co"># map_lgl returns TRUE/FALSE values</span></a>
<a class="sourceLine" id="cb78-14" title="14">some_numbers =<span class="st"> </span><span class="kw">c</span>(<span class="ot">NA</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="ot">NA</span>, <span class="ot">NaN</span>, <span class="ot">Inf</span>, <span class="op">-</span><span class="ot">Inf</span>)</a>
<a class="sourceLine" id="cb78-15" title="15"><span class="kw">map_lgl</span>(some_numbers, is.na)</a>
<a class="sourceLine" id="cb78-16" title="16"><span class="co">#&gt; [1]  TRUE FALSE FALSE FALSE  TRUE  TRUE FALSE FALSE</span></a></code></pre></div>
</div>
<div id="integrating-map-and-tidyrnest" class="section level3">
<h3><span class="header-section-number">4.1.3</span> Integrating <code>map</code> and <code>tidyr::nest</code></h3>
<p>The example show how each map variant can be used. This integrates <code>tidyr::nest</code> with <code>map</code>, and the two are especially complementary.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb79-1" title="1"><span class="co"># nest mtcars into a list of dataframes based on number of cylinders</span></a>
<a class="sourceLine" id="cb79-2" title="2">some_data =<span class="st"> </span><span class="kw">as_tibble</span>(mtcars, <span class="dt">rownames =</span> <span class="st">&quot;car_name&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb79-3" title="3"><span class="st">  </span><span class="kw">group_by</span>(cyl) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb79-4" title="4"><span class="st">  </span><span class="kw">nest</span>()</a>
<a class="sourceLine" id="cb79-5" title="5"></a>
<a class="sourceLine" id="cb79-6" title="6"><span class="co"># get the number of rows per dataframe</span></a>
<a class="sourceLine" id="cb79-7" title="7"><span class="co"># the mean mileage</span></a>
<a class="sourceLine" id="cb79-8" title="8"><span class="co"># and the first car</span></a>
<a class="sourceLine" id="cb79-9" title="9">some_data =<span class="st"> </span>some_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb79-10" title="10"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">n_rows =</span> <span class="kw">map_int</span>(data, nrow),</a>
<a class="sourceLine" id="cb79-11" title="11">         <span class="dt">mean_mpg =</span> <span class="kw">map_dbl</span>(data, <span class="op">~</span><span class="kw">mean</span>(.<span class="op">$</span>mpg)),</a>
<a class="sourceLine" id="cb79-12" title="12">         <span class="dt">first_car =</span> <span class="kw">map_chr</span>(data, <span class="op">~</span><span class="kw">first</span>(.<span class="op">$</span>car_name)))</a>
<a class="sourceLine" id="cb79-13" title="13"></a>
<a class="sourceLine" id="cb79-14" title="14">some_data</a>
<a class="sourceLine" id="cb79-15" title="15"><span class="co">#&gt; # A tibble: 3 x 5</span></a>
<a class="sourceLine" id="cb79-16" title="16"><span class="co">#&gt; # Groups:   cyl [3]</span></a>
<a class="sourceLine" id="cb79-17" title="17"><span class="co">#&gt;     cyl data               n_rows mean_mpg first_car        </span></a>
<a class="sourceLine" id="cb79-18" title="18"><span class="co">#&gt;   &lt;dbl&gt; &lt;list&gt;              &lt;int&gt;    &lt;dbl&gt; &lt;chr&gt;            </span></a>
<a class="sourceLine" id="cb79-19" title="19"><span class="co">#&gt; 1     6 &lt;tibble [7 × 11]&gt;       7     19.7 Mazda RX4        </span></a>
<a class="sourceLine" id="cb79-20" title="20"><span class="co">#&gt; 2     4 &lt;tibble [11 × 11]&gt;     11     26.7 Datsun 710       </span></a>
<a class="sourceLine" id="cb79-21" title="21"><span class="co">#&gt; 3     8 &lt;tibble [14 × 11]&gt;     14     15.1 Hornet Sportabout</span></a></code></pre></div>
<p><code>map</code> accepts multiple functions that are applied in sequence to the input list-like object, but this is confusing to the reader and ill advised.</p>
</div>
<div id="map-variants-returning-dataframes" class="section level3">
<h3><span class="header-section-number">4.1.4</span> <code>map</code> variants returning dataframes</h3>
<p><code>map_df</code> returns data frames, and by default binds dataframes by rows, while <code>map_dfr</code> does this explicitly, and <code>map_dfc</code> does returns a dataframe bound by column.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb80-1" title="1"><span class="co"># split mtcars into 3 dataframes, one per cylinder number</span></a>
<a class="sourceLine" id="cb80-2" title="2">some_list =<span class="st"> </span><span class="kw">split</span>(mtcars, mtcars<span class="op">$</span>cyl)</a>
<a class="sourceLine" id="cb80-3" title="3"></a>
<a class="sourceLine" id="cb80-4" title="4"><span class="co"># get the first two rows of each dataframe</span></a>
<a class="sourceLine" id="cb80-5" title="5"><span class="kw">map_df</span>(some_list, head, <span class="dt">n =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb80-6" title="6"><span class="co">#&gt;    mpg cyl disp  hp drat   wt qsec vs am gear carb</span></a>
<a class="sourceLine" id="cb80-7" title="7"><span class="co">#&gt; 1 22.8   4  108  93 3.85 2.32 18.6  1  1    4    1</span></a>
<a class="sourceLine" id="cb80-8" title="8"><span class="co">#&gt; 2 24.4   4  147  62 3.69 3.19 20.0  1  0    4    2</span></a>
<a class="sourceLine" id="cb80-9" title="9"><span class="co">#&gt; 3 21.0   6  160 110 3.90 2.62 16.5  0  1    4    4</span></a>
<a class="sourceLine" id="cb80-10" title="10"><span class="co">#&gt; 4 21.0   6  160 110 3.90 2.88 17.0  0  1    4    4</span></a>
<a class="sourceLine" id="cb80-11" title="11"><span class="co">#&gt; 5 18.7   8  360 175 3.15 3.44 17.0  0  0    3    2</span></a>
<a class="sourceLine" id="cb80-12" title="12"><span class="co">#&gt; 6 14.3   8  360 245 3.21 3.57 15.8  0  0    3    4</span></a></code></pre></div>
<p><code>map</code> accepts arguments to the function being mapped, such as in the example above, where <code>head()</code> accepts the argument <code>n = 2</code>.</p>
<p><code>map_dfr</code> behaves the same as <code>map_df</code>.</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb81-1" title="1"><span class="co"># the same as above but with a pipe</span></a>
<a class="sourceLine" id="cb81-2" title="2">some_list <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb81-3" title="3"><span class="st">  </span><span class="kw">map_dfr</span>(head, <span class="dt">n =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb81-4" title="4"><span class="co">#&gt;    mpg cyl disp  hp drat   wt qsec vs am gear carb</span></a>
<a class="sourceLine" id="cb81-5" title="5"><span class="co">#&gt; 1 22.8   4  108  93 3.85 2.32 18.6  1  1    4    1</span></a>
<a class="sourceLine" id="cb81-6" title="6"><span class="co">#&gt; 2 24.4   4  147  62 3.69 3.19 20.0  1  0    4    2</span></a>
<a class="sourceLine" id="cb81-7" title="7"><span class="co">#&gt; 3 21.0   6  160 110 3.90 2.62 16.5  0  1    4    4</span></a>
<a class="sourceLine" id="cb81-8" title="8"><span class="co">#&gt; 4 21.0   6  160 110 3.90 2.88 17.0  0  1    4    4</span></a>
<a class="sourceLine" id="cb81-9" title="9"><span class="co">#&gt; 5 18.7   8  360 175 3.15 3.44 17.0  0  0    3    2</span></a>
<a class="sourceLine" id="cb81-10" title="10"><span class="co">#&gt; 6 14.3   8  360 245 3.21 3.57 15.8  0  0    3    4</span></a></code></pre></div>
<p><code>map_dfc</code> binds the resulting 3 data frames of two rows each by column, and automatically repairs the column names, adding a suffix to each duplicate.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb82-1" title="1">some_list <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb82-2" title="2"><span class="st">  </span><span class="kw">map_dfc</span>(head, <span class="dt">n =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb82-3" title="3"><span class="co">#&gt;    mpg cyl disp hp drat   wt qsec vs am gear carb mpg1 cyl1 disp1 hp1 drat1</span></a>
<a class="sourceLine" id="cb82-4" title="4"><span class="co">#&gt; 1 22.8   4  108 93 3.85 2.32 18.6  1  1    4    1   21    6   160 110   3.9</span></a>
<a class="sourceLine" id="cb82-5" title="5"><span class="co">#&gt; 2 24.4   4  147 62 3.69 3.19 20.0  1  0    4    2   21    6   160 110   3.9</span></a>
<a class="sourceLine" id="cb82-6" title="6"><span class="co">#&gt;    wt1 qsec1 vs1 am1 gear1 carb1 mpg2 cyl2 disp2 hp2 drat2  wt2 qsec2 vs2 am2</span></a>
<a class="sourceLine" id="cb82-7" title="7"><span class="co">#&gt; 1 2.62  16.5   0   1     4     4 18.7    8   360 175  3.15 3.44  17.0   0   0</span></a>
<a class="sourceLine" id="cb82-8" title="8"><span class="co">#&gt; 2 2.88  17.0   0   1     4     4 14.3    8   360 245  3.21 3.57  15.8   0   0</span></a>
<a class="sourceLine" id="cb82-9" title="9"><span class="co">#&gt;   gear2 carb2</span></a>
<a class="sourceLine" id="cb82-10" title="10"><span class="co">#&gt; 1     3     2</span></a>
<a class="sourceLine" id="cb82-11" title="11"><span class="co">#&gt; 2     3     4</span></a></code></pre></div>
</div>
<div id="selective-mapping" class="section level3">
<h3><span class="header-section-number">4.1.5</span> Selective mapping</h3>
<p><code>map_at</code> and <code>map_if</code> work like other <code>*_at</code> and <code>*_if</code> functions.</p>
<p>Here, <code>map_if</code> is used to run a linear model only on those dataframes which have sufficient data. The predicate is specified by <code>.p</code>.</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb83-1" title="1"><span class="co"># split mtcars by cylinder number and run an lm only if there are more than 10 rows</span></a>
<a class="sourceLine" id="cb83-2" title="2">data &lt;-<span class="st"> </span><span class="kw">nest</span>(mtcars, <span class="dt">data =</span> <span class="op">-</span>cyl)</a>
<a class="sourceLine" id="cb83-3" title="3"></a>
<a class="sourceLine" id="cb83-4" title="4">data &lt;-<span class="st"> </span><span class="kw">mutate</span>(data,</a>
<a class="sourceLine" id="cb83-5" title="5">               <span class="dt">model =</span> <span class="kw">map_if</span>(<span class="dt">.x =</span> data,</a>
<a class="sourceLine" id="cb83-6" title="6">                              <span class="dt">.p =</span> <span class="cf">function</span>(x){</a>
<a class="sourceLine" id="cb83-7" title="7">                                <span class="kw">nrow</span>(x) <span class="op">&gt;</span><span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb83-8" title="8">                              },</a>
<a class="sourceLine" id="cb83-9" title="9">                              <span class="dt">.f =</span> <span class="cf">function</span>(x){</a>
<a class="sourceLine" id="cb83-10" title="10">                                <span class="kw">lm</span>(mpg <span class="op">~</span><span class="st"> </span>wt, <span class="dt">data =</span> x)</a>
<a class="sourceLine" id="cb83-11" title="11">                              }))</a>
<a class="sourceLine" id="cb83-12" title="12"><span class="co"># check the data structure</span></a>
<a class="sourceLine" id="cb83-13" title="13">data</a>
<a class="sourceLine" id="cb83-14" title="14"><span class="co">#&gt; # A tibble: 3 x 3</span></a>
<a class="sourceLine" id="cb83-15" title="15"><span class="co">#&gt;     cyl data               model            </span></a>
<a class="sourceLine" id="cb83-16" title="16"><span class="co">#&gt;   &lt;dbl&gt; &lt;list&gt;             &lt;list&gt;           </span></a>
<a class="sourceLine" id="cb83-17" title="17"><span class="co">#&gt; 1     6 &lt;tibble [7 × 10]&gt;  &lt;tibble [7 × 10]&gt;</span></a>
<a class="sourceLine" id="cb83-18" title="18"><span class="co">#&gt; 2     4 &lt;tibble [11 × 10]&gt; &lt;lm&gt;             </span></a>
<a class="sourceLine" id="cb83-19" title="19"><span class="co">#&gt; 3     8 &lt;tibble [14 × 10]&gt; &lt;lm&gt;</span></a></code></pre></div>
<p><code>map_at</code> works on specific elements of a list or vector. Come back to this, it’s not particularly useful.</p>
</div>
</div>
<div id="more-map-variants" class="section level2">
<h2><span class="header-section-number">4.2</span> More <code>map</code> variants</h2>
<p><code>map</code> also has variants along the axis of how many elements are operated upon. <code>map2</code> operates on two vectors or list-like elements, and returns a single list as output.
The output has as many elements as the input lists, which must be of the same length.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb84-1" title="1"><span class="co"># consider 2 vectors and replicate the simple vector addition using map2</span></a>
<a class="sourceLine" id="cb84-2" title="2"><span class="kw">map2</span>(<span class="dt">.x =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, </a>
<a class="sourceLine" id="cb84-3" title="3">     <span class="dt">.y =</span> <span class="dv">6</span><span class="op">:</span><span class="dv">10</span>,</a>
<a class="sourceLine" id="cb84-4" title="4">     <span class="dt">.f =</span> sum)</a>
<a class="sourceLine" id="cb84-5" title="5"><span class="co">#&gt; [[1]]</span></a>
<a class="sourceLine" id="cb84-6" title="6"><span class="co">#&gt; [1] 7</span></a>
<a class="sourceLine" id="cb84-7" title="7"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb84-8" title="8"><span class="co">#&gt; [[2]]</span></a>
<a class="sourceLine" id="cb84-9" title="9"><span class="co">#&gt; [1] 9</span></a>
<a class="sourceLine" id="cb84-10" title="10"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb84-11" title="11"><span class="co">#&gt; [[3]]</span></a>
<a class="sourceLine" id="cb84-12" title="12"><span class="co">#&gt; [1] 11</span></a>
<a class="sourceLine" id="cb84-13" title="13"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb84-14" title="14"><span class="co">#&gt; [[4]]</span></a>
<a class="sourceLine" id="cb84-15" title="15"><span class="co">#&gt; [1] 13</span></a>
<a class="sourceLine" id="cb84-16" title="16"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb84-17" title="17"><span class="co">#&gt; [[5]]</span></a>
<a class="sourceLine" id="cb84-18" title="18"><span class="co">#&gt; [1] 15</span></a></code></pre></div>
<div id="mapping-over-two-inputs-with-map2" class="section level3">
<h3><span class="header-section-number">4.2.1</span> Mapping over two inputs with map2</h3>
<p><code>map2</code> has the same variants as <code>map</code>, allowing for different return types.
Here <code>map2_int</code> returns an integer vector.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb85-1" title="1"><span class="co"># consider 2 vectors and replicate the simple vector addition using map2</span></a>
<a class="sourceLine" id="cb85-2" title="2"><span class="kw">map2_int</span>(<span class="dt">.x =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, </a>
<a class="sourceLine" id="cb85-3" title="3">     <span class="dt">.y =</span> <span class="dv">6</span><span class="op">:</span><span class="dv">10</span>,</a>
<a class="sourceLine" id="cb85-4" title="4">     <span class="dt">.f =</span> sum)</a>
<a class="sourceLine" id="cb85-5" title="5"><span class="co">#&gt; [1]  7  9 11 13 15</span></a></code></pre></div>
<p><code>map2</code> doesn’t have <code>_at</code> and <code>_if</code> variants.</p>
<p>One use case for <code>map2</code> is to deal with both a list element and its index, as shown in the example. This may be necessary when the list index is removed in a <code>split</code> or <code>nest</code>. This can also be done with <code>imap</code>, where the index is referred to as <code>.y</code>.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb86-1" title="1"><span class="co"># make a named list for this example</span></a>
<a class="sourceLine" id="cb86-2" title="2">this_list =<span class="st"> </span><span class="kw">list</span>(<span class="dt">a =</span> <span class="st">&quot;first letter&quot;</span>,</a>
<a class="sourceLine" id="cb86-3" title="3">                 <span class="dt">b =</span> <span class="st">&quot;second letter&quot;</span>)</a>
<a class="sourceLine" id="cb86-4" title="4"></a>
<a class="sourceLine" id="cb86-5" title="5"><span class="co"># a not particularly useful example</span></a>
<a class="sourceLine" id="cb86-6" title="6"><span class="kw">map2</span>(this_list, <span class="kw">names</span>(this_list),</a>
<a class="sourceLine" id="cb86-7" title="7">     <span class="cf">function</span>(x, y) {</a>
<a class="sourceLine" id="cb86-8" title="8">       glue<span class="op">::</span><span class="kw">glue</span>(<span class="st">&#39;{x} : {y}&#39;</span>)</a>
<a class="sourceLine" id="cb86-9" title="9">     })</a>
<a class="sourceLine" id="cb86-10" title="10"><span class="co">#&gt; $a</span></a>
<a class="sourceLine" id="cb86-11" title="11"><span class="co">#&gt; first letter : a</span></a>
<a class="sourceLine" id="cb86-12" title="12"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb86-13" title="13"><span class="co">#&gt; $b</span></a>
<a class="sourceLine" id="cb86-14" title="14"><span class="co">#&gt; second letter : b</span></a>
<a class="sourceLine" id="cb86-15" title="15"></a>
<a class="sourceLine" id="cb86-16" title="16"><span class="co"># imap can also do this</span></a>
<a class="sourceLine" id="cb86-17" title="17"><span class="kw">imap</span>(this_list,</a>
<a class="sourceLine" id="cb86-18" title="18">     <span class="cf">function</span>(x, .y){</a>
<a class="sourceLine" id="cb86-19" title="19">       glue<span class="op">::</span><span class="kw">glue</span>(<span class="st">&#39;{x} : {.y}&#39;</span>)</a>
<a class="sourceLine" id="cb86-20" title="20">     })</a>
<a class="sourceLine" id="cb86-21" title="21"><span class="co">#&gt; $a</span></a>
<a class="sourceLine" id="cb86-22" title="22"><span class="co">#&gt; first letter : a</span></a>
<a class="sourceLine" id="cb86-23" title="23"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb86-24" title="24"><span class="co">#&gt; $b</span></a>
<a class="sourceLine" id="cb86-25" title="25"><span class="co">#&gt; second letter : b</span></a></code></pre></div>
</div>
<div id="mapping-over-multiple-inputs-with-pmap" class="section level3">
<h3><span class="header-section-number">4.2.2</span> Mapping over multiple inputs with pmap</h3>
<p><code>pmap</code> instead operates on a list of multiple list-like objects, and also comes with the same return type variants as <code>map</code>. The example shows both aspects of <code>pmap</code> using <code>pmap_chr</code>.</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb87-1" title="1"><span class="co"># operate on three different lists</span></a>
<a class="sourceLine" id="cb87-2" title="2">list_<span class="dv">01</span> =<span class="st"> </span><span class="kw">as.list</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb87-3" title="3">list_<span class="dv">02</span> =<span class="st"> </span><span class="kw">as.list</span>(letters[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>])</a>
<a class="sourceLine" id="cb87-4" title="4">list_<span class="dv">03</span> =<span class="st"> </span><span class="kw">as.list</span>(<span class="kw">rainbow</span>(<span class="dv">3</span>))</a>
<a class="sourceLine" id="cb87-5" title="5"></a>
<a class="sourceLine" id="cb87-6" title="6"><span class="co"># print a few statements</span></a>
<a class="sourceLine" id="cb87-7" title="7"><span class="kw">pmap_chr</span>(<span class="kw">list</span>(list_<span class="dv">01</span>, list_<span class="dv">02</span>, list_<span class="dv">03</span>),</a>
<a class="sourceLine" id="cb87-8" title="8">     <span class="cf">function</span>(l1, l2, l3){</a>
<a class="sourceLine" id="cb87-9" title="9">       glue<span class="op">::</span><span class="kw">glue</span>(<span class="st">&#39;number {l1}, letter {l2}, colour {l3}&#39;</span>)</a>
<a class="sourceLine" id="cb87-10" title="10">     })</a>
<a class="sourceLine" id="cb87-11" title="11"><span class="co">#&gt; [1] &quot;number 1, letter a, colour #FF0000FF&quot;</span></a>
<a class="sourceLine" id="cb87-12" title="12"><span class="co">#&gt; [2] &quot;number 2, letter b, colour #00FF00FF&quot;</span></a>
<a class="sourceLine" id="cb87-13" title="13"><span class="co">#&gt; [3] &quot;number 3, letter c, colour #0000FFFF&quot;</span></a></code></pre></div>
</div>
<div id="mapping-at-depth" class="section level3">
<h3><span class="header-section-number">4.2.3</span> Mapping at depth</h3>
<p>Lists are often nested, that is, a list element may itself be a list. It is possible to map a function over elements as a specific depth.</p>
<p>In the example, <code>mtcars</code> is split by cylinders, and then by gears, creating a two-level list, with the second layer operated on.</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb88-1" title="1"><span class="co"># use map to make a 2 level list</span></a>
<a class="sourceLine" id="cb88-2" title="2">this_list =<span class="st"> </span><span class="kw">split</span>(mtcars, mtcars<span class="op">$</span>cyl) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb88-3" title="3"><span class="st">  </span><span class="kw">map</span>(<span class="cf">function</span>(df){ <span class="kw">split</span>(df, df<span class="op">$</span>gear) })</a>
<a class="sourceLine" id="cb88-4" title="4"></a>
<a class="sourceLine" id="cb88-5" title="5"><span class="co"># map over the second level to count the number of </span></a>
<a class="sourceLine" id="cb88-6" title="6"><span class="co"># cars with N gears in the set of cars with M cylinders</span></a>
<a class="sourceLine" id="cb88-7" title="7"><span class="co"># display only for cyl = 4</span></a>
<a class="sourceLine" id="cb88-8" title="8"><span class="kw">map_depth</span>(this_list[<span class="dv">1</span>], <span class="dv">2</span>, nrow)</a>
<a class="sourceLine" id="cb88-9" title="9"><span class="co">#&gt; $`4`</span></a>
<a class="sourceLine" id="cb88-10" title="10"><span class="co">#&gt; $`4`$`3`</span></a>
<a class="sourceLine" id="cb88-11" title="11"><span class="co">#&gt; [1] 1</span></a>
<a class="sourceLine" id="cb88-12" title="12"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb88-13" title="13"><span class="co">#&gt; $`4`$`4`</span></a>
<a class="sourceLine" id="cb88-14" title="14"><span class="co">#&gt; [1] 8</span></a>
<a class="sourceLine" id="cb88-15" title="15"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb88-16" title="16"><span class="co">#&gt; $`4`$`5`</span></a>
<a class="sourceLine" id="cb88-17" title="17"><span class="co">#&gt; [1] 2</span></a></code></pre></div>
</div>
<div id="iteration-without-a-return" class="section level3">
<h3><span class="header-section-number">4.2.4</span> Iteration without a return</h3>
<p><code>map</code> and its variants have a return type, which is either a list or a vector.
However, it is often necessary to iterate a function over a list-like object for that function’s side effects, such as printing a message to screen, plotting a series of figures, or saving to file.</p>
<p><code>walk</code> is the function for this task. It has only the variants <code>walk2</code>, <code>iwalk</code>, and <code>pwalk</code>, whose logic is similar to <code>map2</code>, <code>imap</code>, and <code>pmap</code>. In the example, the function applied to each list element is intended to print a message.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb89-1" title="1">this_list =<span class="st"> </span><span class="kw">split</span>(mtcars, mtcars<span class="op">$</span>cyl)</a>
<a class="sourceLine" id="cb89-2" title="2"></a>
<a class="sourceLine" id="cb89-3" title="3"><span class="kw">iwalk</span>(this_list,</a>
<a class="sourceLine" id="cb89-4" title="4">     <span class="cf">function</span>(df, .y){</a>
<a class="sourceLine" id="cb89-5" title="5">       <span class="kw">message</span>(glue<span class="op">::</span><span class="kw">glue</span>(<span class="st">&#39;{nrow(df)} cars with {.y} cylinders&#39;</span>))</a>
<a class="sourceLine" id="cb89-6" title="6">     })</a></code></pre></div>
</div>
<div id="modify-rather-than-map" class="section level3">
<h3><span class="header-section-number">4.2.5</span> Modify rather than map</h3>
<p>When the return type is expected to be the same as the input type, that is, a list returning a list, or a character vector returning the same, <code>modify</code> can help with keeping strictly to those expectations.</p>
<p>In the example, simply adding 2 to each vector element produces an error, because the output is a <code>numeric</code>, or <code>double</code>. <code>modify</code> helps ensure some type safety in this way.</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb90-1" title="1">vec =<span class="st"> </span><span class="kw">as.integer</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>)</a>
<a class="sourceLine" id="cb90-2" title="2"></a>
<a class="sourceLine" id="cb90-3" title="3"><span class="kw">tryCatch</span>(</a>
<a class="sourceLine" id="cb90-4" title="4">  <span class="dt">expr =</span> {</a>
<a class="sourceLine" id="cb90-5" title="5">    </a>
<a class="sourceLine" id="cb90-6" title="6">    <span class="co"># this is what we want you to look at</span></a>
<a class="sourceLine" id="cb90-7" title="7">    </a>
<a class="sourceLine" id="cb90-8" title="8">    <span class="kw">modify</span>(vec, <span class="cf">function</span>(x) { (x <span class="op">+</span><span class="st"> </span><span class="dv">2</span>) })</a>
<a class="sourceLine" id="cb90-9" title="9">    </a>
<a class="sourceLine" id="cb90-10" title="10">    },</a>
<a class="sourceLine" id="cb90-11" title="11">  </a>
<a class="sourceLine" id="cb90-12" title="12">  <span class="co"># do not pay attention to this</span></a>
<a class="sourceLine" id="cb90-13" title="13">  <span class="dt">error =</span> <span class="cf">function</span>(e){</a>
<a class="sourceLine" id="cb90-14" title="14">    <span class="kw">print</span>(<span class="kw">toString</span>(e))</a>
<a class="sourceLine" id="cb90-15" title="15">  }</a>
<a class="sourceLine" id="cb90-16" title="16">)</a>
<a class="sourceLine" id="cb90-17" title="17"><span class="co">#&gt; [1] &quot;Error: Can&#39;t coerce element 1 from a double to a integer\n&quot;</span></a></code></pre></div>
<p>Converting the output to an integer, which was the original input type, serves as a solution.</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb91-1" title="1"><span class="kw">modify</span>(vec, <span class="cf">function</span>(x) { <span class="kw">as.integer</span>(x <span class="op">+</span><span class="st"> </span><span class="dv">2</span>) })</a>
<a class="sourceLine" id="cb91-2" title="2"><span class="co">#&gt;  [1]  3  4  5  6  7  8  9 10 11 12</span></a></code></pre></div>
<div id="a-note-on-invoke" class="section level4 unnumbered">
<h4>A note on <code>invoke</code></h4>
<p><code>invoke</code> used to be a wrapper around <code>do.call</code>, and can still be found with its family of functions in <code>purrr</code>. It is however retired in favour of functionality already present in <code>map</code> and <code>rlang::exec</code>, the latter of which will be covered in another session.</p>
</div>
</div>
</div>
<div id="working-with-lists" class="section level2">
<h2><span class="header-section-number">4.3</span> Working with lists</h2>
<p><code>purrr</code> has a number of functions to work with lists, especially lists that are not nested list-columns in a tibble.</p>
<div id="filtering-lists" class="section level3">
<h3><span class="header-section-number">4.3.1</span> Filtering lists</h3>
<p>Lists can be filtered on any predicate using <code>keep</code>, while the special case <code>compact</code> is applied when the empty elements of a list are to be filtered out. <code>discard</code> is the opposite of <code>keep</code>, and keeps only elements not satisfying a condition. Again, the predicate is specified by <code>.p</code>.</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb92-1" title="1"><span class="co"># a list containing numbers</span></a>
<a class="sourceLine" id="cb92-2" title="2">this_list =<span class="st"> </span><span class="kw">list</span>(<span class="dt">a =</span> <span class="dv">1</span>, <span class="dt">b =</span> <span class="dv">-1</span>, <span class="dt">c =</span> <span class="dv">2</span>, <span class="dt">d =</span> <span class="ot">NULL</span>, <span class="dt">e =</span> <span class="ot">NA</span>)</a>
<a class="sourceLine" id="cb92-3" title="3"></a>
<a class="sourceLine" id="cb92-4" title="4"><span class="co"># remove the empty element</span></a>
<a class="sourceLine" id="cb92-5" title="5"><span class="co"># this must be done before using keep on the list</span></a>
<a class="sourceLine" id="cb92-6" title="6">this_list =<span class="st"> </span><span class="kw">compact</span>(this_list)</a></code></pre></div>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb93-1" title="1"><span class="co"># use discard to remove the NA</span></a>
<a class="sourceLine" id="cb93-2" title="2">this_list =<span class="st"> </span><span class="kw">discard</span>(this_list, <span class="dt">.p =</span>is.na)</a>
<a class="sourceLine" id="cb93-3" title="3"></a>
<a class="sourceLine" id="cb93-4" title="4"><span class="co"># keep list elements which are positive</span></a>
<a class="sourceLine" id="cb93-5" title="5"><span class="kw">keep</span>(this_list, <span class="dt">.p =</span> <span class="cf">function</span>(x){ x <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span> })</a>
<a class="sourceLine" id="cb93-6" title="6"><span class="co">#&gt; $a</span></a>
<a class="sourceLine" id="cb93-7" title="7"><span class="co">#&gt; [1] 1</span></a>
<a class="sourceLine" id="cb93-8" title="8"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb93-9" title="9"><span class="co">#&gt; $c</span></a>
<a class="sourceLine" id="cb93-10" title="10"><span class="co">#&gt; [1] 2</span></a></code></pre></div>
<p><code>head_while</code> is bit of an odd case, which returns all elements of a list-like object in sequence until the first one fails to satisfy a predicate, specified by <code>.p</code>.</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb94-1" title="1"><span class="dv">1</span><span class="op">:</span><span class="dv">10</span> <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb94-2" title="2"><span class="st">  </span><span class="kw">head_while</span>(<span class="dt">.p =</span> <span class="cf">function</span>(x) x <span class="op">&lt;</span><span class="st"> </span><span class="dv">5</span>)</a>
<a class="sourceLine" id="cb94-3" title="3"><span class="co">#&gt; [1] 1 2 3 4</span></a></code></pre></div>
</div>
<div id="summarising-lists" class="section level3">
<h3><span class="header-section-number">4.3.2</span> Summarising lists</h3>
<p>The <code>purrr</code> functions <code>every</code>, <code>some</code>, <code>has_element</code>, <code>detect</code>, <code>detect_index</code>, and <code>vec_depth</code> help determine whether a list passes a certain logical test or not. These are seldom used and are not discussed here.</p>
</div>
<div id="reduction-and-accumulation" class="section level3">
<h3><span class="header-section-number">4.3.3</span> Reduction and accumulation</h3>
<p><code>reduce</code> helps combine elements along a list using a specific function. Consider the example below where list elements are concatenated into a single vector.</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb95-1" title="1">this_list =<span class="st"> </span><span class="kw">list</span>(<span class="dt">a =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">b =</span> <span class="dv">3</span><span class="op">:</span><span class="dv">4</span>, <span class="dt">c =</span> <span class="dv">5</span><span class="op">:</span><span class="dv">10</span>)</a>
<a class="sourceLine" id="cb95-2" title="2"></a>
<a class="sourceLine" id="cb95-3" title="3"><span class="kw">reduce</span>(this_list, c)</a>
<a class="sourceLine" id="cb95-4" title="4"><span class="co">#&gt;  [1]  1  2  3  3  4  5  6  7  8  9 10</span></a></code></pre></div>
<p>The way <code>reduce</code> works is to take the first element, <code>a</code> in the example, and find its intersection with <code>b</code>, and to take the result and find its intersection with <code>c</code>.</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb96-1" title="1">this_list =<span class="st"> </span><span class="kw">list</span>(<span class="dt">a =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">b =</span> <span class="dv">3</span><span class="op">:</span><span class="dv">6</span>, <span class="dt">c =</span> <span class="dv">3</span><span class="op">:</span><span class="dv">10</span>)</a>
<a class="sourceLine" id="cb96-2" title="2"></a>
<a class="sourceLine" id="cb96-3" title="3"><span class="kw">reduce</span>(this_list, intersect)</a>
<a class="sourceLine" id="cb96-4" title="4"><span class="co">#&gt; [1] 3</span></a></code></pre></div>
<p><code>accumulate</code> works very similarly, except it retains the intermediate products. The first element is retained as is. <code>accumulate2</code> and <code>reduce2</code> work on two lists, following the same logic as <code>map2</code> etc.
Both functions can be used in much more complex ways than demonstrated here.</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb97-1" title="1"><span class="co"># make a list</span></a>
<a class="sourceLine" id="cb97-2" title="2">this_list =<span class="st"> </span><span class="kw">list</span>(<span class="dt">a =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">b =</span> <span class="dv">3</span><span class="op">:</span><span class="dv">6</span>, <span class="dt">c =</span> <span class="dv">5</span><span class="op">:</span><span class="dv">10</span>, <span class="dt">d =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">12</span>))</a>
<a class="sourceLine" id="cb97-3" title="3"></a>
<a class="sourceLine" id="cb97-4" title="4"><span class="co"># a multiple accumulate can help</span></a>
<a class="sourceLine" id="cb97-5" title="5"><span class="kw">accumulate</span>(this_list, union, <span class="dt">.dir =</span> <span class="st">&quot;forward&quot;</span>)</a>
<a class="sourceLine" id="cb97-6" title="6"><span class="co">#&gt; $a</span></a>
<a class="sourceLine" id="cb97-7" title="7"><span class="co">#&gt; [1] 1 2 3</span></a>
<a class="sourceLine" id="cb97-8" title="8"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb97-9" title="9"><span class="co">#&gt; $b</span></a>
<a class="sourceLine" id="cb97-10" title="10"><span class="co">#&gt; [1] 1 2 3 4 5 6</span></a>
<a class="sourceLine" id="cb97-11" title="11"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb97-12" title="12"><span class="co">#&gt; $c</span></a>
<a class="sourceLine" id="cb97-13" title="13"><span class="co">#&gt;  [1]  1  2  3  4  5  6  7  8  9 10</span></a>
<a class="sourceLine" id="cb97-14" title="14"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb97-15" title="15"><span class="co">#&gt; $d</span></a>
<a class="sourceLine" id="cb97-16" title="16"><span class="co">#&gt;  [1]  1  2  3  4  5  6  7  8  9 10 12</span></a></code></pre></div>
</div>
<div id="miscellaneous-operation" class="section level3">
<h3><span class="header-section-number">4.3.4</span> Miscellaneous operation</h3>
<p><code>purrr</code> offers a few more functions to work with lists (or list like objects). <code>prepend</code> works very similarly to <code>append</code>, except it adds to the head of a list. <code>splice</code> adds multiple objects together in a list. <code>splice</code> will break the existing list structure of input lists.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb98-1" title="1"><span class="co"># use prepend to add values to the head of a list</span></a>
<a class="sourceLine" id="cb98-2" title="2"><span class="kw">prepend</span>(<span class="dt">x =</span> <span class="kw">list</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>), <span class="dt">values =</span> <span class="kw">list</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>))</a>
<a class="sourceLine" id="cb98-3" title="3"><span class="co">#&gt; [[1]]</span></a>
<a class="sourceLine" id="cb98-4" title="4"><span class="co">#&gt; [1] &quot;1&quot;</span></a>
<a class="sourceLine" id="cb98-5" title="5"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb98-6" title="6"><span class="co">#&gt; [[2]]</span></a>
<a class="sourceLine" id="cb98-7" title="7"><span class="co">#&gt; [1] &quot;2&quot;</span></a>
<a class="sourceLine" id="cb98-8" title="8"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb98-9" title="9"><span class="co">#&gt; [[3]]</span></a>
<a class="sourceLine" id="cb98-10" title="10"><span class="co">#&gt; [1] &quot;a&quot;</span></a>
<a class="sourceLine" id="cb98-11" title="11"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb98-12" title="12"><span class="co">#&gt; [[4]]</span></a>
<a class="sourceLine" id="cb98-13" title="13"><span class="co">#&gt; [1] &quot;b&quot;</span></a>
<a class="sourceLine" id="cb98-14" title="14"></a>
<a class="sourceLine" id="cb98-15" title="15"><span class="co"># use splice to add multiple elements together</span></a>
<a class="sourceLine" id="cb98-16" title="16"><span class="kw">splice</span>(<span class="kw">list</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>), <span class="kw">list</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>), <span class="st">&quot;something else&quot;</span>)</a>
<a class="sourceLine" id="cb98-17" title="17"><span class="co">#&gt; [[1]]</span></a>
<a class="sourceLine" id="cb98-18" title="18"><span class="co">#&gt; [1] &quot;a&quot;</span></a>
<a class="sourceLine" id="cb98-19" title="19"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb98-20" title="20"><span class="co">#&gt; [[2]]</span></a>
<a class="sourceLine" id="cb98-21" title="21"><span class="co">#&gt; [1] &quot;b&quot;</span></a>
<a class="sourceLine" id="cb98-22" title="22"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb98-23" title="23"><span class="co">#&gt; [[3]]</span></a>
<a class="sourceLine" id="cb98-24" title="24"><span class="co">#&gt; [1] &quot;1&quot;</span></a>
<a class="sourceLine" id="cb98-25" title="25"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb98-26" title="26"><span class="co">#&gt; [[4]]</span></a>
<a class="sourceLine" id="cb98-27" title="27"><span class="co">#&gt; [1] &quot;2&quot;</span></a>
<a class="sourceLine" id="cb98-28" title="28"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb98-29" title="29"><span class="co">#&gt; [[5]]</span></a>
<a class="sourceLine" id="cb98-30" title="30"><span class="co">#&gt; [1] &quot;something else&quot;</span></a></code></pre></div>
<p><code>flatten</code> has a similar behaviour, and converts a list of vectors or list of lists to a single list-like object. <code>flatten_*</code> options allow the output type to be specified.</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb99-1" title="1">this_list =<span class="st"> </span><span class="kw">list</span>(<span class="dt">a =</span> <span class="kw">rep</span>(<span class="st">&quot;a&quot;</span>, <span class="dv">3</span>),</a>
<a class="sourceLine" id="cb99-2" title="2">                 <span class="dt">b =</span> <span class="kw">rep</span>(<span class="st">&quot;b&quot;</span>, <span class="dv">4</span>))</a>
<a class="sourceLine" id="cb99-3" title="3"></a>
<a class="sourceLine" id="cb99-4" title="4">this_list</a>
<a class="sourceLine" id="cb99-5" title="5"><span class="co">#&gt; $a</span></a>
<a class="sourceLine" id="cb99-6" title="6"><span class="co">#&gt; [1] &quot;a&quot; &quot;a&quot; &quot;a&quot;</span></a>
<a class="sourceLine" id="cb99-7" title="7"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb99-8" title="8"><span class="co">#&gt; $b</span></a>
<a class="sourceLine" id="cb99-9" title="9"><span class="co">#&gt; [1] &quot;b&quot; &quot;b&quot; &quot;b&quot; &quot;b&quot;</span></a>
<a class="sourceLine" id="cb99-10" title="10"></a>
<a class="sourceLine" id="cb99-11" title="11"><span class="co"># use flatten chr to get a character vector</span></a>
<a class="sourceLine" id="cb99-12" title="12"><span class="kw">flatten_chr</span>(this_list)</a>
<a class="sourceLine" id="cb99-13" title="13"><span class="co">#&gt; [1] &quot;a&quot; &quot;a&quot; &quot;a&quot; &quot;b&quot; &quot;b&quot; &quot;b&quot; &quot;b&quot;</span></a></code></pre></div>
<p><code>transpose</code> shifts the index order in multi-level lists. This is seen in the example, where the <code>gear</code> goes from being the index of the second level to the index of the first.</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb100-1" title="1">this_list =<span class="st"> </span><span class="kw">split</span>(mtcars, mtcars<span class="op">$</span>cyl) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb100-2" title="2"><span class="st">  </span><span class="kw">map</span>(<span class="cf">function</span>(df) <span class="kw">split</span>(df, df<span class="op">$</span>gear))</a>
<a class="sourceLine" id="cb100-3" title="3"></a>
<a class="sourceLine" id="cb100-4" title="4"><span class="co"># from a list of lists where cars are divided by cylinders and then</span></a>
<a class="sourceLine" id="cb100-5" title="5"><span class="co"># gears, this is now a list of lists where cars are divided by</span></a>
<a class="sourceLine" id="cb100-6" title="6"><span class="co"># gears and then cylinders</span></a>
<a class="sourceLine" id="cb100-7" title="7"><span class="kw">transpose</span>(this_list[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb100-8" title="8"><span class="co">#&gt; $`3`</span></a>
<a class="sourceLine" id="cb100-9" title="9"><span class="co">#&gt; $`3`$`4`</span></a>
<a class="sourceLine" id="cb100-10" title="10"><span class="co">#&gt;                mpg cyl disp hp drat   wt qsec vs am gear carb</span></a>
<a class="sourceLine" id="cb100-11" title="11"><span class="co">#&gt; Toyota Corona 21.5   4  120 97  3.7 2.46   20  1  0    3    1</span></a>
<a class="sourceLine" id="cb100-12" title="12"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb100-13" title="13"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb100-14" title="14"><span class="co">#&gt; $`4`</span></a>
<a class="sourceLine" id="cb100-15" title="15"><span class="co">#&gt; $`4`$`4`</span></a>
<a class="sourceLine" id="cb100-16" title="16"><span class="co">#&gt;                 mpg cyl  disp  hp drat   wt qsec vs am gear carb</span></a>
<a class="sourceLine" id="cb100-17" title="17"><span class="co">#&gt; Datsun 710     22.8   4 108.0  93 3.85 2.32 18.6  1  1    4    1</span></a>
<a class="sourceLine" id="cb100-18" title="18"><span class="co">#&gt; Merc 240D      24.4   4 146.7  62 3.69 3.19 20.0  1  0    4    2</span></a>
<a class="sourceLine" id="cb100-19" title="19"><span class="co">#&gt; Merc 230       22.8   4 140.8  95 3.92 3.15 22.9  1  0    4    2</span></a>
<a class="sourceLine" id="cb100-20" title="20"><span class="co">#&gt; Fiat 128       32.4   4  78.7  66 4.08 2.20 19.5  1  1    4    1</span></a>
<a class="sourceLine" id="cb100-21" title="21"><span class="co">#&gt; Honda Civic    30.4   4  75.7  52 4.93 1.61 18.5  1  1    4    2</span></a>
<a class="sourceLine" id="cb100-22" title="22"><span class="co">#&gt; Toyota Corolla 33.9   4  71.1  65 4.22 1.83 19.9  1  1    4    1</span></a>
<a class="sourceLine" id="cb100-23" title="23"><span class="co">#&gt; Fiat X1-9      27.3   4  79.0  66 4.08 1.94 18.9  1  1    4    1</span></a>
<a class="sourceLine" id="cb100-24" title="24"><span class="co">#&gt; Volvo 142E     21.4   4 121.0 109 4.11 2.78 18.6  1  1    4    2</span></a>
<a class="sourceLine" id="cb100-25" title="25"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb100-26" title="26"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb100-27" title="27"><span class="co">#&gt; $`5`</span></a>
<a class="sourceLine" id="cb100-28" title="28"><span class="co">#&gt; $`5`$`4`</span></a>
<a class="sourceLine" id="cb100-29" title="29"><span class="co">#&gt;                mpg cyl  disp  hp drat   wt qsec vs am gear carb</span></a>
<a class="sourceLine" id="cb100-30" title="30"><span class="co">#&gt; Porsche 914-2 26.0   4 120.3  91 4.43 2.14 16.7  0  1    5    2</span></a>
<a class="sourceLine" id="cb100-31" title="31"><span class="co">#&gt; Lotus Europa  30.4   4  95.1 113 3.77 1.51 16.9  1  1    5    2</span></a></code></pre></div>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-manipulation-with-dplyr.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/pratikunterwegs/tres-tidy-tutorial/edit/master/04_working_with_lists.rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
