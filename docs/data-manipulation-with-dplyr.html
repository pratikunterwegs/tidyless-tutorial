<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Section 4 Data manipulation with dplyr | TRES Tidyverse Tutorial</title>
  <meta name="description" content="Section 4 Data manipulation with dplyr | TRES Tidyverse Tutorial" />
  <meta name="generator" content="bookdown 0.19 and GitBook 2.6.7" />

  <meta property="og:title" content="Section 4 Data manipulation with dplyr | TRES Tidyverse Tutorial" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Section 4 Data manipulation with dplyr | TRES Tidyverse Tutorial" />
  <meta name="github-repo" content="pratikunterwegs/tres-tidy-tutorial" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Section 4 Data manipulation with dplyr | TRES Tidyverse Tutorial" />
  
  <meta name="twitter:description" content="Section 4 Data manipulation with dplyr | TRES Tidyverse Tutorial" />
  

<meta name="author" content="Raphael, Pratik and Theo" />


<meta name="date" content="2020-06-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="working-with-lists-and-iteration.html"/>

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Outline</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#about"><i class="fa fa-check"></i>About</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#schedule"><i class="fa fa-check"></i>Schedule</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#possible-extras"><i class="fa fa-check"></i>Possible extras</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#join"><i class="fa fa-check"></i>Join</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="reading-files-and-string-manipulation.html"><a href="reading-files-and-string-manipulation.html"><i class="fa fa-check"></i><b>1</b> Reading files and string manipulation</a><ul>
<li class="chapter" data-level="1.1" data-path="reading-files-and-string-manipulation.html"><a href="reading-files-and-string-manipulation.html#data-import-and-export-with-readr"><i class="fa fa-check"></i><b>1.1</b> Data import and export with <code>readr</code></a><ul>
<li class="chapter" data-level="1.1.1" data-path="reading-files-and-string-manipulation.html"><a href="reading-files-and-string-manipulation.html#reading-data"><i class="fa fa-check"></i><b>1.1.1</b> Reading data</a></li>
<li class="chapter" data-level="1.1.2" data-path="reading-files-and-string-manipulation.html"><a href="reading-files-and-string-manipulation.html#writing-data"><i class="fa fa-check"></i><b>1.1.2</b> Writing data</a></li>
<li class="chapter" data-level="1.1.3" data-path="reading-files-and-string-manipulation.html"><a href="reading-files-and-string-manipulation.html#reading-and-writing-lines"><i class="fa fa-check"></i><b>1.1.3</b> Reading and writing lines</a></li>
<li class="chapter" data-level="" data-path="reading-files-and-string-manipulation.html"><a href="reading-files-and-string-manipulation.html#excel-files"><i class="fa fa-check"></i>Excel files</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="reading-files-and-string-manipulation.html"><a href="reading-files-and-string-manipulation.html#string-manipulation-with-stringr"><i class="fa fa-check"></i><b>1.2</b> String manipulation with <code>stringr</code></a><ul>
<li class="chapter" data-level="1.2.1" data-path="reading-files-and-string-manipulation.html"><a href="reading-files-and-string-manipulation.html#putting-strings-together"><i class="fa fa-check"></i><b>1.2.1</b> Putting strings together</a></li>
<li class="chapter" data-level="1.2.2" data-path="reading-files-and-string-manipulation.html"><a href="reading-files-and-string-manipulation.html#detecting-strings"><i class="fa fa-check"></i><b>1.2.2</b> Detecting strings</a></li>
<li class="chapter" data-level="1.2.3" data-path="reading-files-and-string-manipulation.html"><a href="reading-files-and-string-manipulation.html#matching-strings"><i class="fa fa-check"></i><b>1.2.3</b> Matching strings</a></li>
<li class="chapter" data-level="1.2.4" data-path="reading-files-and-string-manipulation.html"><a href="reading-files-and-string-manipulation.html#simpler-pattern-extraction"><i class="fa fa-check"></i><b>1.2.4</b> Simpler pattern extraction</a></li>
<li class="chapter" data-level="1.2.5" data-path="reading-files-and-string-manipulation.html"><a href="reading-files-and-string-manipulation.html#breaking-strings-apart"><i class="fa fa-check"></i><b>1.2.5</b> Breaking strings apart</a></li>
<li class="chapter" data-level="1.2.6" data-path="reading-files-and-string-manipulation.html"><a href="reading-files-and-string-manipulation.html#replacing-string-elements"><i class="fa fa-check"></i><b>1.2.6</b> Replacing string elements</a></li>
<li class="chapter" data-level="1.2.7" data-path="reading-files-and-string-manipulation.html"><a href="reading-files-and-string-manipulation.html#subsetting-within-strings"><i class="fa fa-check"></i><b>1.2.7</b> Subsetting within strings</a></li>
<li class="chapter" data-level="1.2.8" data-path="reading-files-and-string-manipulation.html"><a href="reading-files-and-string-manipulation.html#padding-and-truncating-strings"><i class="fa fa-check"></i><b>1.2.8</b> Padding and truncating strings</a></li>
<li class="chapter" data-level="1.2.9" data-path="reading-files-and-string-manipulation.html"><a href="reading-files-and-string-manipulation.html#stringr-aspects-not-covered-here"><i class="fa fa-check"></i><b>1.2.9</b> Stringr aspects not covered here</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="reading-files-and-string-manipulation.html"><a href="reading-files-and-string-manipulation.html#string-interpolation-with-glue"><i class="fa fa-check"></i><b>1.3</b> String interpolation with <code>glue</code></a></li>
<li class="chapter" data-level="1.4" data-path="reading-files-and-string-manipulation.html"><a href="reading-files-and-string-manipulation.html#strings-in-ggplot"><i class="fa fa-check"></i><b>1.4</b> Strings in <code>ggplot</code></a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="reshaping-data-tables-in-the-tidyverse.html"><a href="reshaping-data-tables-in-the-tidyverse.html"><i class="fa fa-check"></i><b>2</b> Reshaping data tables in the tidyverse</a><ul>
<li class="chapter" data-level="2.1" data-path="reshaping-data-tables-in-the-tidyverse.html"><a href="reshaping-data-tables-in-the-tidyverse.html#the-new-data-frame-tibble"><i class="fa fa-check"></i><b>2.1</b> 1. The new data frame: tibble</a></li>
<li class="chapter" data-level="2.2" data-path="reshaping-data-tables-in-the-tidyverse.html"><a href="reshaping-data-tables-in-the-tidyverse.html#the-concept-of-tidy-data"><i class="fa fa-check"></i><b>2.2</b> 2. The concept of tidy data</a></li>
<li class="chapter" data-level="2.3" data-path="reshaping-data-tables-in-the-tidyverse.html"><a href="reshaping-data-tables-in-the-tidyverse.html#reshaping-with-tidyr"><i class="fa fa-check"></i><b>2.3</b> 3. Reshaping with <code>tidyr</code></a><ul>
<li class="chapter" data-level="2.3.1" data-path="reshaping-data-tables-in-the-tidyverse.html"><a href="reshaping-data-tables-in-the-tidyverse.html#pivoting"><i class="fa fa-check"></i><b>2.3.1</b> 3.1. Pivoting</a></li>
<li class="chapter" data-level="2.3.2" data-path="reshaping-data-tables-in-the-tidyverse.html"><a href="reshaping-data-tables-in-the-tidyverse.html#handling-missing-values"><i class="fa fa-check"></i><b>2.3.2</b> 3.2. Handling missing values</a></li>
<li class="chapter" data-level="2.3.3" data-path="reshaping-data-tables-in-the-tidyverse.html"><a href="reshaping-data-tables-in-the-tidyverse.html#splitting-and-combining-cells"><i class="fa fa-check"></i><b>2.3.3</b> 3.3. Splitting and combining cells</a></li>
<li class="chapter" data-level="2.3.4" data-path="reshaping-data-tables-in-the-tidyverse.html"><a href="reshaping-data-tables-in-the-tidyverse.html#expanding-tables-using-combinations"><i class="fa fa-check"></i><b>2.3.4</b> 3.4. Expanding tables using combinations</a></li>
<li class="chapter" data-level="2.3.5" data-path="reshaping-data-tables-in-the-tidyverse.html"><a href="reshaping-data-tables-in-the-tidyverse.html#nesting"><i class="fa fa-check"></i><b>2.3.5</b> 3.5. Nesting</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="reshaping-data-tables-in-the-tidyverse.html"><a href="reshaping-data-tables-in-the-tidyverse.html#extra-factors-and-the-forcats-package"><i class="fa fa-check"></i><b>2.4</b> 4. Extra: factors and the <code>forcats</code> package</a><ul>
<li class="chapter" data-level="2.4.1" data-path="reshaping-data-tables-in-the-tidyverse.html"><a href="reshaping-data-tables-in-the-tidyverse.html#reordering-a-factor"><i class="fa fa-check"></i><b>2.4.1</b> 4.1. Reordering a factor</a></li>
<li class="chapter" data-level="2.4.2" data-path="reshaping-data-tables-in-the-tidyverse.html"><a href="reshaping-data-tables-in-the-tidyverse.html#factor-levels"><i class="fa fa-check"></i><b>2.4.2</b> 4.2. Factor levels</a></li>
<li class="chapter" data-level="2.4.3" data-path="reshaping-data-tables-in-the-tidyverse.html"><a href="reshaping-data-tables-in-the-tidyverse.html#bonus-dropping-levels"><i class="fa fa-check"></i><b>2.4.3</b> 4.3. Bonus: dropping levels</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="reshaping-data-tables-in-the-tidyverse.html"><a href="reshaping-data-tables-in-the-tidyverse.html#external-resources"><i class="fa fa-check"></i><b>2.5</b> 5. External resources</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="working-with-lists-and-iteration.html"><a href="working-with-lists-and-iteration.html"><i class="fa fa-check"></i><b>3</b> Working with lists and iteration</a><ul>
<li class="chapter" data-level="3.1" data-path="working-with-lists-and-iteration.html"><a href="working-with-lists-and-iteration.html#basic-iteration-with-map"><i class="fa fa-check"></i><b>3.1</b> Basic iteration with <code>map</code></a><ul>
<li class="chapter" data-level="3.1.1" data-path="working-with-lists-and-iteration.html"><a href="working-with-lists-and-iteration.html#map-basic-use"><i class="fa fa-check"></i><b>3.1.1</b> <code>map</code> basic use</a></li>
<li class="chapter" data-level="3.1.2" data-path="working-with-lists-and-iteration.html"><a href="working-with-lists-and-iteration.html#map-variants-returning-vectors"><i class="fa fa-check"></i><b>3.1.2</b> <code>map</code> variants returning vectors</a></li>
<li><a href="working-with-lists-and-iteration.html#integrating-map-and-tidyrnest">Integrating <code>map</code> and <code>tidyr::nest</code></a></li>
<li class="chapter" data-level="3.1.3" data-path="working-with-lists-and-iteration.html"><a href="working-with-lists-and-iteration.html#map-variants-returning-dataframes"><i class="fa fa-check"></i><b>3.1.3</b> <code>map</code> variants returning dataframes</a></li>
<li class="chapter" data-level="3.1.4" data-path="working-with-lists-and-iteration.html"><a href="working-with-lists-and-iteration.html#selective-mapping"><i class="fa fa-check"></i><b>3.1.4</b> Selective mapping</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="working-with-lists-and-iteration.html"><a href="working-with-lists-and-iteration.html#more-map-variants"><i class="fa fa-check"></i><b>3.2</b> More <code>map</code> variants</a><ul>
<li class="chapter" data-level="3.2.1" data-path="working-with-lists-and-iteration.html"><a href="working-with-lists-and-iteration.html#map2"><i class="fa fa-check"></i><b>3.2.1</b> <code>map2</code></a></li>
<li class="chapter" data-level="3.2.2" data-path="working-with-lists-and-iteration.html"><a href="working-with-lists-and-iteration.html#pmap"><i class="fa fa-check"></i><b>3.2.2</b> <code>pmap</code></a></li>
<li class="chapter" data-level="3.2.3" data-path="working-with-lists-and-iteration.html"><a href="working-with-lists-and-iteration.html#walk"><i class="fa fa-check"></i><b>3.2.3</b> <code>walk</code></a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="working-with-lists-and-iteration.html"><a href="working-with-lists-and-iteration.html#modification-in-place"><i class="fa fa-check"></i><b>3.3</b> Modification in place</a></li>
<li class="chapter" data-level="3.4" data-path="working-with-lists-and-iteration.html"><a href="working-with-lists-and-iteration.html#working-with-lists"><i class="fa fa-check"></i><b>3.4</b> Working with lists</a><ul>
<li class="chapter" data-level="3.4.1" data-path="working-with-lists-and-iteration.html"><a href="working-with-lists-and-iteration.html#filtering-lists"><i class="fa fa-check"></i><b>3.4.1</b> Filtering lists</a></li>
<li class="chapter" data-level="3.4.2" data-path="working-with-lists-and-iteration.html"><a href="working-with-lists-and-iteration.html#summarising-lists"><i class="fa fa-check"></i><b>3.4.2</b> Summarising lists</a></li>
<li class="chapter" data-level="3.4.3" data-path="working-with-lists-and-iteration.html"><a href="working-with-lists-and-iteration.html#reduction-and-accumulation"><i class="fa fa-check"></i><b>3.4.3</b> Reduction and accumulation</a></li>
<li class="chapter" data-level="3.4.4" data-path="working-with-lists-and-iteration.html"><a href="working-with-lists-and-iteration.html#miscellaneous-operation"><i class="fa fa-check"></i><b>3.4.4</b> Miscellaneous operation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-manipulation-with-dplyr.html"><a href="data-manipulation-with-dplyr.html"><i class="fa fa-check"></i><b>4</b> Data manipulation with <code>dplyr</code></a><ul>
<li class="chapter" data-level="4.1" data-path="data-manipulation-with-dplyr.html"><a href="data-manipulation-with-dplyr.html#introduction"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="data-manipulation-with-dplyr.html"><a href="data-manipulation-with-dplyr.html#example-data-of-the-day"><i class="fa fa-check"></i><b>4.2</b> Example data of the day</a></li>
<li class="chapter" data-level="4.3" data-path="data-manipulation-with-dplyr.html"><a href="data-manipulation-with-dplyr.html#select-variables-with-select"><i class="fa fa-check"></i><b>4.3</b> Select variables with <code>select()</code></a></li>
<li class="chapter" data-level="4.4" data-path="data-manipulation-with-dplyr.html"><a href="data-manipulation-with-dplyr.html#select-observations-with-filter"><i class="fa fa-check"></i><b>4.4</b> Select observations with <code>filter()</code></a></li>
<li class="chapter" data-level="4.5" data-path="data-manipulation-with-dplyr.html"><a href="data-manipulation-with-dplyr.html#create-new-variables-with-mutate"><i class="fa fa-check"></i><b>4.5</b> Create new variables with <code>mutate()</code></a></li>
<li class="chapter" data-level="4.6" data-path="data-manipulation-with-dplyr.html"><a href="data-manipulation-with-dplyr.html#grouped-results-with-group_by-and-summarise"><i class="fa fa-check"></i><b>4.6</b> Grouped results with <code>group_by()</code> and <code>summarise()</code></a></li>
<li class="chapter" data-level="4.7" data-path="data-manipulation-with-dplyr.html"><a href="data-manipulation-with-dplyr.html#scoped-variables"><i class="fa fa-check"></i><b>4.7</b> Scoped variables</a></li>
<li class="chapter" data-level="4.8" data-path="data-manipulation-with-dplyr.html"><a href="data-manipulation-with-dplyr.html#more"><i class="fa fa-check"></i><b>4.8</b> More !</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">TRES Tidyverse Tutorial</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data-manipulation-with-dplyr" class="section level1">
<h1><span class="header-section-number">Section 4</span> Data manipulation with <code>dplyr</code></h1>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb189-1" data-line-number="1"><span class="co"># load the tidyverse</span></a>
<a class="sourceLine" id="cb189-2" data-line-number="2"><span class="kw">library</span>(tidyverse)</a></code></pre></div>
<div id="introduction" class="section level2">
<h2><span class="header-section-number">4.1</span> Introduction</h2>
<p>Reminders from last weeks: pipe operator, tidy tables, ggplot</p>
<p>Why dplyr ? dplyr vs base R</p>
</div>
<div id="example-data-of-the-day" class="section level2">
<h2><span class="header-section-number">4.2</span> Example data of the day</h2>
<p>Through this tutorial, we will be using mammal trait data from the <a href="https://megapast2future.github.io/PHYLACINE_1.2/">Phylacine</a> database. The dataset contains information on mass, diet, life habit, etc, for more than all living species of mammals. Let’s have a look.</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb190-1" data-line-number="1">phylacine &lt;-<span class="st"> </span>readr<span class="op">::</span><span class="kw">read_csv</span>(<span class="st">&quot;data/phylacine_traits.csv&quot;</span>)</a>
<a class="sourceLine" id="cb190-2" data-line-number="2">phylacine</a></code></pre></div>
<pre><code>## # A tibble: 5,831 x 24
##    Binomial.1.2 Order.1.2 Family.1.2 Genus.1.2 Species.1.2 Terrestrial Marine
##    &lt;chr&gt;        &lt;chr&gt;     &lt;chr&gt;      &lt;chr&gt;     &lt;chr&gt;             &lt;dbl&gt;  &lt;dbl&gt;
##  1 Abditomys_l… Rodentia  Muridae    Abditomys latidens              1      0
##  2 Abeomelomys… Rodentia  Muridae    Abeomelo… sevia                 1      0
##  3 Abrawayaomy… Rodentia  Cricetidae Abrawaya… ruschii               1      0
##  4 Abrocoma_be… Rodentia  Abrocomid… Abrocoma  bennettii             1      0
##  5 Abrocoma_bo… Rodentia  Abrocomid… Abrocoma  boliviensis           1      0
##  6 Abrocoma_bu… Rodentia  Abrocomid… Abrocoma  budini                1      0
##  7 Abrocoma_ci… Rodentia  Abrocomid… Abrocoma  cinerea               1      0
##  8 Abrocoma_fa… Rodentia  Abrocomid… Abrocoma  famatina              1      0
##  9 Abrocoma_sh… Rodentia  Abrocomid… Abrocoma  shistacea             1      0
## 10 Abrocoma_us… Rodentia  Abrocomid… Abrocoma  uspallata             1      0
## # … with 5,821 more rows, and 17 more variables: Freshwater &lt;dbl&gt;,
## #   Aerial &lt;dbl&gt;, Life.Habit.Method &lt;chr&gt;, Life.Habit.Source &lt;chr&gt;,
## #   Mass.g &lt;dbl&gt;, Mass.Method &lt;chr&gt;, Mass.Source &lt;chr&gt;, Mass.Comparison &lt;chr&gt;,
## #   Mass.Comparison.Source &lt;chr&gt;, Island.Endemicity &lt;chr&gt;,
## #   IUCN.Status.1.2 &lt;chr&gt;, Added.IUCN.Status.1.2 &lt;chr&gt;, Diet.Plant &lt;dbl&gt;,
## #   Diet.Vertebrate &lt;dbl&gt;, Diet.Invertebrate &lt;dbl&gt;, Diet.Method &lt;chr&gt;,
## #   Diet.Source &lt;chr&gt;</code></pre>
<p>Note the friendly output given by the <code>tibble</code> (as opposed to a <code>data.frame</code>). <code>readr</code> automatically stores the content it reads in a <code>tibble</code>, tidyverse oblige. You should know however that <code>dplyr</code> doesn’t require your data to be in a tibble, a regular <code>data.frame</code> will work just as fine.</p>
<p>Most of the <code>dplyr</code> verbs covered in the next sections assume your data is <em>tidy</em>: wide format, variables as column, 1 observation per row. Not that tehy won’t work if your data isn’t tidy, but the results could be very different from what I’m going to show here. Fortunately, the phylacine trait dataset appears to be tidy: there is one unique entry for each species.</p>
<p>The first operation I’m going to run on this table is changing the names with
<code>rename()</code>. Some people prefer their tea without sugar, and I <a href="https://style.tidyverse.org/syntax.html#object-names">prefer</a> my
variable names without uppercase characters, dots or (if possible) numbers.
This will give me the opportunity to introduce the trivial syntax
of <code>dplyr</code> verbs.</p>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb192-1" data-line-number="1">phylacine &lt;-<span class="st"> </span>phylacine <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb192-2" data-line-number="2"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">rename</span>(</a>
<a class="sourceLine" id="cb192-3" data-line-number="3">    <span class="st">&quot;binomial&quot;</span> =<span class="st"> </span>Binomial.<span class="fl">1.2</span>,</a>
<a class="sourceLine" id="cb192-4" data-line-number="4">    <span class="st">&quot;order&quot;</span> =<span class="st"> </span>Order.<span class="fl">1.2</span>,</a>
<a class="sourceLine" id="cb192-5" data-line-number="5">    <span class="st">&quot;family&quot;</span> =<span class="st"> </span>Family.<span class="fl">1.2</span>,</a>
<a class="sourceLine" id="cb192-6" data-line-number="6">    <span class="st">&quot;genus&quot;</span> =<span class="st"> </span>Genus.<span class="fl">1.2</span>,</a>
<a class="sourceLine" id="cb192-7" data-line-number="7">    <span class="st">&quot;species&quot;</span> =<span class="st"> </span>Species.<span class="fl">1.2</span>,</a>
<a class="sourceLine" id="cb192-8" data-line-number="8">    <span class="st">&quot;terrestrial&quot;</span> =<span class="st"> </span>Terrestrial,</a>
<a class="sourceLine" id="cb192-9" data-line-number="9">    <span class="st">&quot;marine&quot;</span> =<span class="st"> </span>Marine,</a>
<a class="sourceLine" id="cb192-10" data-line-number="10">    <span class="st">&quot;freshwater&quot;</span> =<span class="st"> </span>Freshwater,</a>
<a class="sourceLine" id="cb192-11" data-line-number="11">    <span class="st">&quot;aerial&quot;</span> =<span class="st"> </span>Aerial,</a>
<a class="sourceLine" id="cb192-12" data-line-number="12">    <span class="st">&quot;life_habit_method&quot;</span> =<span class="st"> </span>Life.Habit.Method,</a>
<a class="sourceLine" id="cb192-13" data-line-number="13">    <span class="st">&quot;life_habit_source&quot;</span> =<span class="st"> </span>Life.Habit.Source,</a>
<a class="sourceLine" id="cb192-14" data-line-number="14">    <span class="st">&quot;mass_g&quot;</span> =<span class="st"> </span>Mass.g,</a>
<a class="sourceLine" id="cb192-15" data-line-number="15">    <span class="st">&quot;mass_method&quot;</span> =<span class="st"> </span>Mass.Method,</a>
<a class="sourceLine" id="cb192-16" data-line-number="16">    <span class="st">&quot;mass_source&quot;</span> =<span class="st"> </span>Mass.Source,</a>
<a class="sourceLine" id="cb192-17" data-line-number="17">    <span class="st">&quot;mass_comparison&quot;</span> =<span class="st"> </span>Mass.Comparison,</a>
<a class="sourceLine" id="cb192-18" data-line-number="18">    <span class="st">&quot;mass_comparison_source&quot;</span> =<span class="st"> </span>Mass.Comparison.Source,</a>
<a class="sourceLine" id="cb192-19" data-line-number="19">    <span class="st">&quot;island_endemicity&quot;</span> =<span class="st"> </span>Island.Endemicity,</a>
<a class="sourceLine" id="cb192-20" data-line-number="20">    <span class="st">&quot;iucn_status&quot;</span> =<span class="st"> </span>IUCN.Status.<span class="fl">1.2</span>, <span class="co"># not even for acronyms</span></a>
<a class="sourceLine" id="cb192-21" data-line-number="21">    <span class="st">&quot;added_iucn_status&quot;</span> =<span class="st">  </span>Added.IUCN.Status.<span class="fl">1.2</span>,</a>
<a class="sourceLine" id="cb192-22" data-line-number="22">    <span class="st">&quot;diet_plant&quot;</span> =<span class="st"> </span>Diet.Plant,</a>
<a class="sourceLine" id="cb192-23" data-line-number="23">    <span class="st">&quot;diet_vertebrate&quot;</span> =<span class="st"> </span>Diet.Vertebrate,</a>
<a class="sourceLine" id="cb192-24" data-line-number="24">    <span class="st">&quot;diet_invertebrate&quot;</span> =<span class="st"> </span>Diet.Invertebrate,</a>
<a class="sourceLine" id="cb192-25" data-line-number="25">    <span class="st">&quot;diet_method&quot;</span> =<span class="st"> </span>Diet.Method,</a>
<a class="sourceLine" id="cb192-26" data-line-number="26">    <span class="st">&quot;diet_source&quot;</span> =<span class="st"> </span>Diet.Source</a>
<a class="sourceLine" id="cb192-27" data-line-number="27">  )</a></code></pre></div>
<p>For convenience, I’m going to use the pipe operator (<code>%&gt;%</code>) that we’ve seen
before, through this chapter. All <code>dplyr</code> functions are built to work with the
pipe (i.e, their firstargument is always <code>data</code>), but again, this is not
compulsory. I could do</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb193-1" data-line-number="1">phylacine &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw">rename</span>(</a>
<a class="sourceLine" id="cb193-2" data-line-number="2">  <span class="dt">data =</span> phylacine,</a>
<a class="sourceLine" id="cb193-3" data-line-number="3">  <span class="st">&quot;binomial&quot;</span> =<span class="st"> </span>Binomial.<span class="fl">1.2</span>,</a>
<a class="sourceLine" id="cb193-4" data-line-number="4">  <span class="co"># ...</span></a>
<a class="sourceLine" id="cb193-5" data-line-number="5">)</a></code></pre></div>
<p>Note how columns are referred to. Once the data as been passed as an argument,
no need to refer to it anymore, <code>dplyr</code> understands that you’re dealing with
variables inside that data frame. So drop that <code>data$var</code>, <code>data[, &quot;var&quot;]</code>,
and, if you’ve read <em>The R book</em>, forget the very existence of <code>attach()</code>.</p>
<p>Finally, I should mention that you can refer to variables names either with strings or directly as objects, whether you’re reading or creating them:</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb194-1" data-line-number="1">phylacine2 &lt;-<span class="st"> </span>readr<span class="op">::</span><span class="kw">read_csv</span>(<span class="st">&quot;data/phylacine_traits.csv&quot;</span>)</a>
<a class="sourceLine" id="cb194-2" data-line-number="2"></a>
<a class="sourceLine" id="cb194-3" data-line-number="3">phylacine2 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb194-4" data-line-number="4"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">rename</span>(</a>
<a class="sourceLine" id="cb194-5" data-line-number="5">    <span class="co"># this works</span></a>
<a class="sourceLine" id="cb194-6" data-line-number="6">    <span class="dt">binomial =</span> Binomial.<span class="fl">1.2</span></a>
<a class="sourceLine" id="cb194-7" data-line-number="7">  )</a>
<a class="sourceLine" id="cb194-8" data-line-number="8">phylacine2 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb194-9" data-line-number="9"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">rename</span>(</a>
<a class="sourceLine" id="cb194-10" data-line-number="10">    <span class="co"># this works too!</span></a>
<a class="sourceLine" id="cb194-11" data-line-number="11">    <span class="dt">binomial =</span> <span class="st">&quot;Binomial.1.2&quot;</span></a>
<a class="sourceLine" id="cb194-12" data-line-number="12">  )</a>
<a class="sourceLine" id="cb194-13" data-line-number="13">phylacine2 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb194-14" data-line-number="14"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">rename</span>(</a>
<a class="sourceLine" id="cb194-15" data-line-number="15">    <span class="co"># guess what</span></a>
<a class="sourceLine" id="cb194-16" data-line-number="16">    <span class="st">&quot;binomial&quot;</span> =<span class="st"> &quot;Binomial.1.2&quot;</span></a>
<a class="sourceLine" id="cb194-17" data-line-number="17">  )</a></code></pre></div>
</div>
<div id="select-variables-with-select" class="section level2">
<h2><span class="header-section-number">4.3</span> Select variables with <code>select()</code></h2>
<p>To extract a set of variables (i.e. columns), use the conveniently-named <code>select()</code>.</p>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb195-1" data-line-number="1">phylacine_subset &lt;-<span class="st"> </span>phylacine <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb195-2" data-line-number="2"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(</a>
<a class="sourceLine" id="cb195-3" data-line-number="3">    binomial, </a>
<a class="sourceLine" id="cb195-4" data-line-number="4">    order, </a>
<a class="sourceLine" id="cb195-5" data-line-number="5">    terrestrial, </a>
<a class="sourceLine" id="cb195-6" data-line-number="6">    marine, </a>
<a class="sourceLine" id="cb195-7" data-line-number="7">    freshwater, </a>
<a class="sourceLine" id="cb195-8" data-line-number="8">    aerial</a>
<a class="sourceLine" id="cb195-9" data-line-number="9">  )</a>
<a class="sourceLine" id="cb195-10" data-line-number="10">phylacine_subset</a></code></pre></div>
<pre><code>## # A tibble: 5,831 x 6
##    binomial             order    terrestrial marine freshwater aerial
##    &lt;chr&gt;                &lt;chr&gt;          &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt;  &lt;dbl&gt;
##  1 Abditomys_latidens   Rodentia           1      0          0      0
##  2 Abeomelomys_sevia    Rodentia           1      0          0      0
##  3 Abrawayaomys_ruschii Rodentia           1      0          0      0
##  4 Abrocoma_bennettii   Rodentia           1      0          0      0
##  5 Abrocoma_boliviensis Rodentia           1      0          0      0
##  6 Abrocoma_budini      Rodentia           1      0          0      0
##  7 Abrocoma_cinerea     Rodentia           1      0          0      0
##  8 Abrocoma_famatina    Rodentia           1      0          0      0
##  9 Abrocoma_shistacea   Rodentia           1      0          0      0
## 10 Abrocoma_uspallata   Rodentia           1      0          0      0
## # … with 5,821 more rows</code></pre>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb197-1" data-line-number="1"><span class="co"># Single variable</span></a>
<a class="sourceLine" id="cb197-2" data-line-number="2">phylacine <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(family)</a></code></pre></div>
<pre><code>## # A tibble: 5,831 x 1
##    family     
##    &lt;chr&gt;      
##  1 Muridae    
##  2 Muridae    
##  3 Cricetidae 
##  4 Abrocomidae
##  5 Abrocomidae
##  6 Abrocomidae
##  7 Abrocomidae
##  8 Abrocomidae
##  9 Abrocomidae
## 10 Abrocomidae
## # … with 5,821 more rows</code></pre>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb199-1" data-line-number="1"><span class="co"># A set of variables</span></a>
<a class="sourceLine" id="cb199-2" data-line-number="2">phylacine <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(genus, species, mass_g)</a></code></pre></div>
<pre><code>## # A tibble: 5,831 x 3
##    genus        species     mass_g
##    &lt;chr&gt;        &lt;chr&gt;        &lt;dbl&gt;
##  1 Abditomys    latidens      269 
##  2 Abeomelomys  sevia          52 
##  3 Abrawayaomys ruschii        63 
##  4 Abrocoma     bennettii     250 
##  5 Abrocoma     boliviensis   158 
##  6 Abrocoma     budini        361.
##  7 Abrocoma     cinerea       250 
##  8 Abrocoma     famatina      233.
##  9 Abrocoma     shistacea     276.
## 10 Abrocoma     uspallata     246.
## # … with 5,821 more rows</code></pre>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb201-1" data-line-number="1"><span class="co"># A range of variables</span></a>
<a class="sourceLine" id="cb201-2" data-line-number="2">phylacine <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(family<span class="op">:</span>terrestrial)</a></code></pre></div>
<pre><code>## # A tibble: 5,831 x 4
##    family      genus        species     terrestrial
##    &lt;chr&gt;       &lt;chr&gt;        &lt;chr&gt;             &lt;dbl&gt;
##  1 Muridae     Abditomys    latidens              1
##  2 Muridae     Abeomelomys  sevia                 1
##  3 Cricetidae  Abrawayaomys ruschii               1
##  4 Abrocomidae Abrocoma     bennettii             1
##  5 Abrocomidae Abrocoma     boliviensis           1
##  6 Abrocomidae Abrocoma     budini                1
##  7 Abrocomidae Abrocoma     cinerea               1
##  8 Abrocomidae Abrocoma     famatina              1
##  9 Abrocomidae Abrocoma     shistacea             1
## 10 Abrocomidae Abrocoma     uspallata             1
## # … with 5,821 more rows</code></pre>
<p><code>select()</code> can also <em>exclude</em> variables:</p>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb203-1" data-line-number="1">phylacine <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>binomial)</a></code></pre></div>
<pre><code>## # A tibble: 5,831 x 23
##    order family genus species terrestrial marine freshwater aerial
##    &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;         &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt;  &lt;dbl&gt;
##  1 Rode… Murid… Abdi… latide…           1      0          0      0
##  2 Rode… Murid… Abeo… sevia             1      0          0      0
##  3 Rode… Crice… Abra… ruschii           1      0          0      0
##  4 Rode… Abroc… Abro… bennet…           1      0          0      0
##  5 Rode… Abroc… Abro… bolivi…           1      0          0      0
##  6 Rode… Abroc… Abro… budini            1      0          0      0
##  7 Rode… Abroc… Abro… cinerea           1      0          0      0
##  8 Rode… Abroc… Abro… famati…           1      0          0      0
##  9 Rode… Abroc… Abro… shista…           1      0          0      0
## 10 Rode… Abroc… Abro… uspall…           1      0          0      0
## # … with 5,821 more rows, and 15 more variables: life_habit_method &lt;chr&gt;,
## #   life_habit_source &lt;chr&gt;, mass_g &lt;dbl&gt;, mass_method &lt;chr&gt;,
## #   mass_source &lt;chr&gt;, mass_comparison &lt;chr&gt;, mass_comparison_source &lt;chr&gt;,
## #   island_endemicity &lt;chr&gt;, iucn_status &lt;chr&gt;, added_iucn_status &lt;chr&gt;,
## #   diet_plant &lt;dbl&gt;, diet_vertebrate &lt;dbl&gt;, diet_invertebrate &lt;dbl&gt;,
## #   diet_method &lt;chr&gt;, diet_source &lt;chr&gt;</code></pre>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb205-1" data-line-number="1">phylacine <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>(binomial<span class="op">:</span>species))</a></code></pre></div>
<pre><code>## # A tibble: 5,831 x 19
##    terrestrial marine freshwater aerial life_habit_meth… life_habit_sour… mass_g
##          &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;            &lt;chr&gt;             &lt;dbl&gt;
##  1           1      0          0      0 Reported         IUCN. 2016. IUC…   269 
##  2           1      0          0      0 Reported         IUCN. 2016. IUC…    52 
##  3           1      0          0      0 Reported         IUCN. 2016. IUC…    63 
##  4           1      0          0      0 Reported         IUCN. 2016. IUC…   250 
##  5           1      0          0      0 Reported         IUCN. 2016. IUC…   158 
##  6           1      0          0      0 Reported         IUCN. 2016. IUC…   361.
##  7           1      0          0      0 Reported         IUCN. 2016. IUC…   250 
##  8           1      0          0      0 Reported         IUCN. 2016. IUC…   233.
##  9           1      0          0      0 Reported         IUCN. 2016. IUC…   276.
## 10           1      0          0      0 Reported         IUCN. 2016. IUC…   246.
## # … with 5,821 more rows, and 12 more variables: mass_method &lt;chr&gt;,
## #   mass_source &lt;chr&gt;, mass_comparison &lt;chr&gt;, mass_comparison_source &lt;chr&gt;,
## #   island_endemicity &lt;chr&gt;, iucn_status &lt;chr&gt;, added_iucn_status &lt;chr&gt;,
## #   diet_plant &lt;dbl&gt;, diet_vertebrate &lt;dbl&gt;, diet_invertebrate &lt;dbl&gt;,
## #   diet_method &lt;chr&gt;, diet_source &lt;chr&gt;</code></pre>
<p><code>select()</code> and <code>rename()</code> are pretty similar, and in fact, <code>select()</code> can also rename variables along the way:</p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb207-1" data-line-number="1">phylacine <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="st">&quot;fam&quot;</span> =<span class="st"> </span>family)</a></code></pre></div>
<pre><code>## # A tibble: 5,831 x 1
##    fam        
##    &lt;chr&gt;      
##  1 Muridae    
##  2 Muridae    
##  3 Cricetidae 
##  4 Abrocomidae
##  5 Abrocomidae
##  6 Abrocomidae
##  7 Abrocomidae
##  8 Abrocomidae
##  9 Abrocomidae
## 10 Abrocomidae
## # … with 5,821 more rows</code></pre>
<p>And you can mix all of that at once:</p>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb209-1" data-line-number="1">phylacine <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(</a>
<a class="sourceLine" id="cb209-2" data-line-number="2">  <span class="st">&quot;fam&quot;</span> =<span class="st"> </span>family,</a>
<a class="sourceLine" id="cb209-3" data-line-number="3">  genus<span class="op">:</span>freshwater,</a>
<a class="sourceLine" id="cb209-4" data-line-number="4">  <span class="op">-</span>terrestrial</a>
<a class="sourceLine" id="cb209-5" data-line-number="5">)</a></code></pre></div>
<pre><code>## # A tibble: 5,831 x 5
##    fam         genus        species     marine freshwater
##    &lt;chr&gt;       &lt;chr&gt;        &lt;chr&gt;        &lt;dbl&gt;      &lt;dbl&gt;
##  1 Muridae     Abditomys    latidens         0          0
##  2 Muridae     Abeomelomys  sevia            0          0
##  3 Cricetidae  Abrawayaomys ruschii          0          0
##  4 Abrocomidae Abrocoma     bennettii        0          0
##  5 Abrocomidae Abrocoma     boliviensis      0          0
##  6 Abrocomidae Abrocoma     budini           0          0
##  7 Abrocomidae Abrocoma     cinerea          0          0
##  8 Abrocomidae Abrocoma     famatina         0          0
##  9 Abrocomidae Abrocoma     shistacea        0          0
## 10 Abrocomidae Abrocoma     uspallata        0          0
## # … with 5,821 more rows</code></pre>
</div>
<div id="select-observations-with-filter" class="section level2">
<h2><span class="header-section-number">4.4</span> Select observations with <code>filter()</code></h2>
<p>Conditional selection of observations is performed through <code>filter()</code>. This i sarguably the most useful function in the entire package. The syntax uses conditions involving the variables, just as you would use for <code>if</code> statements or <code>while</code> loops.</p>
<p>For example, I might want to extract mammals that are above a certain mass:</p>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb211-1" data-line-number="1"><span class="co"># megafauna</span></a>
<a class="sourceLine" id="cb211-2" data-line-number="2">phylacine <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb211-3" data-line-number="3"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(mass_g <span class="op">&gt;</span><span class="st"> </span><span class="fl">1e5</span>) <span class="co"># 100 kg</span></a></code></pre></div>
<pre><code>## # A tibble: 302 x 24
##    binomial order family genus species terrestrial marine freshwater aerial
##    &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;         &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt;  &lt;dbl&gt;
##  1 Ailurop… Carn… Ursid… Ailu… melano…           1      0          0      0
##  2 Alcelap… Ceta… Bovid… Alce… busela…           1      0          0      0
##  3 Alces_a… Ceta… Cervi… Alces alces             1      0          0      0
##  4 Archaeo… Prim… Palae… Arch… fontoy…           1      0          0      0
##  5 Arctoce… Carn… Otari… Arct… forste…           1      1          0      0
##  6 Arctoce… Carn… Otari… Arct… pusill…           1      1          0      0
##  7 Arctoce… Carn… Otari… Arct… townse…           1      1          0      0
##  8 Arctodu… Carn… Ursid… Arct… simus             1      0          0      0
##  9 Arctoth… Carn… Ursid… Arct… tarije…           1      0          0      0
## 10 Babyrou… Ceta… Suidae Baby… togean…           1      0          1      0
## # … with 292 more rows, and 15 more variables: life_habit_method &lt;chr&gt;,
## #   life_habit_source &lt;chr&gt;, mass_g &lt;dbl&gt;, mass_method &lt;chr&gt;,
## #   mass_source &lt;chr&gt;, mass_comparison &lt;chr&gt;, mass_comparison_source &lt;chr&gt;,
## #   island_endemicity &lt;chr&gt;, iucn_status &lt;chr&gt;, added_iucn_status &lt;chr&gt;,
## #   diet_plant &lt;dbl&gt;, diet_vertebrate &lt;dbl&gt;, diet_invertebrate &lt;dbl&gt;,
## #   diet_method &lt;chr&gt;, diet_source &lt;chr&gt;</code></pre>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb213-1" data-line-number="1"><span class="co"># living megafauna</span></a>
<a class="sourceLine" id="cb213-2" data-line-number="2">phylacine <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb213-3" data-line-number="3"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(mass_g <span class="op">&gt;</span><span class="st"> </span><span class="fl">1e5</span>, iucn_status <span class="op">!=</span><span class="st"> &quot;EP&quot;</span>)</a></code></pre></div>
<pre><code>## # A tibble: 178 x 24
##    binomial order family genus species terrestrial marine freshwater aerial
##    &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;         &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt;  &lt;dbl&gt;
##  1 Ailurop… Carn… Ursid… Ailu… melano…           1      0          0      0
##  2 Alcelap… Ceta… Bovid… Alce… busela…           1      0          0      0
##  3 Alces_a… Ceta… Cervi… Alces alces             1      0          0      0
##  4 Arctoce… Carn… Otari… Arct… forste…           1      1          0      0
##  5 Arctoce… Carn… Otari… Arct… pusill…           1      1          0      0
##  6 Arctoce… Carn… Otari… Arct… townse…           1      1          0      0
##  7 Babyrou… Ceta… Suidae Baby… togean…           1      0          1      0
##  8 Balaena… Ceta… Balae… Bala… mystic…           0      1          0      0
##  9 Balaeno… Ceta… Balae… Bala… acutor…           0      1          0      0
## 10 Balaeno… Ceta… Balae… Bala… bonaer…           0      1          0      0
## # … with 168 more rows, and 15 more variables: life_habit_method &lt;chr&gt;,
## #   life_habit_source &lt;chr&gt;, mass_g &lt;dbl&gt;, mass_method &lt;chr&gt;,
## #   mass_source &lt;chr&gt;, mass_comparison &lt;chr&gt;, mass_comparison_source &lt;chr&gt;,
## #   island_endemicity &lt;chr&gt;, iucn_status &lt;chr&gt;, added_iucn_status &lt;chr&gt;,
## #   diet_plant &lt;dbl&gt;, diet_vertebrate &lt;dbl&gt;, diet_invertebrate &lt;dbl&gt;,
## #   diet_method &lt;chr&gt;, diet_source &lt;chr&gt;</code></pre>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb215-1" data-line-number="1"><span class="co"># Are there any flying mammals besides bats?</span></a>
<a class="sourceLine" id="cb215-2" data-line-number="2">phylacine <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb215-3" data-line-number="3"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(aerial <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, order <span class="op">!=</span><span class="st"> &quot;Chiroptera&quot;</span>) </a></code></pre></div>
<pre><code>## # A tibble: 0 x 24
## # … with 24 variables: binomial &lt;chr&gt;, order &lt;chr&gt;, family &lt;chr&gt;, genus &lt;chr&gt;,
## #   species &lt;chr&gt;, terrestrial &lt;dbl&gt;, marine &lt;dbl&gt;, freshwater &lt;dbl&gt;,
## #   aerial &lt;dbl&gt;, life_habit_method &lt;chr&gt;, life_habit_source &lt;chr&gt;,
## #   mass_g &lt;dbl&gt;, mass_method &lt;chr&gt;, mass_source &lt;chr&gt;, mass_comparison &lt;chr&gt;,
## #   mass_comparison_source &lt;chr&gt;, island_endemicity &lt;chr&gt;, iucn_status &lt;chr&gt;,
## #   added_iucn_status &lt;chr&gt;, diet_plant &lt;dbl&gt;, diet_vertebrate &lt;dbl&gt;,
## #   diet_invertebrate &lt;dbl&gt;, diet_method &lt;chr&gt;, diet_source &lt;chr&gt;</code></pre>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb217-1" data-line-number="1"><span class="co"># no :(</span></a>
<a class="sourceLine" id="cb217-2" data-line-number="2"></a>
<a class="sourceLine" id="cb217-3" data-line-number="3"><span class="co"># That one species</span></a>
<a class="sourceLine" id="cb217-4" data-line-number="4">phylacine <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(binomial <span class="op">==</span><span class="st"> &quot;Homo_sapiens&quot;</span>)</a></code></pre></div>
<pre><code>## # A tibble: 1 x 24
##   binomial order family genus species terrestrial marine freshwater aerial
##   &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;         &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt;  &lt;dbl&gt;
## 1 Homo_sa… Prim… Homin… Homo  sapiens           1      0          0      0
## # … with 15 more variables: life_habit_method &lt;chr&gt;, life_habit_source &lt;chr&gt;,
## #   mass_g &lt;dbl&gt;, mass_method &lt;chr&gt;, mass_source &lt;chr&gt;, mass_comparison &lt;chr&gt;,
## #   mass_comparison_source &lt;chr&gt;, island_endemicity &lt;chr&gt;, iucn_status &lt;chr&gt;,
## #   added_iucn_status &lt;chr&gt;, diet_plant &lt;dbl&gt;, diet_vertebrate &lt;dbl&gt;,
## #   diet_invertebrate &lt;dbl&gt;, diet_method &lt;chr&gt;, diet_source &lt;chr&gt;</code></pre>
<p>Tip: <code>dplyr</code> introduces the useful function <code>between()</code> that does exactly what the name implies</p>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb219-1" data-line-number="1"><span class="kw">between</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dv">2</span>, <span class="dv">4</span>)</a></code></pre></div>
<pre><code>## [1] FALSE  TRUE  TRUE  TRUE FALSE</code></pre>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb221-1" data-line-number="1"><span class="co"># Mesofauna</span></a>
<a class="sourceLine" id="cb221-2" data-line-number="2">phylacine <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(mass_g <span class="op">&gt;</span><span class="st"> </span><span class="fl">1e3</span>, mass_g <span class="op">&lt;</span><span class="st"> </span><span class="fl">1e5</span>) <span class="co"># base</span></a></code></pre></div>
<pre><code>## # A tibble: 1,126 x 24
##    binomial order family genus species terrestrial marine freshwater aerial
##    &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;         &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt;  &lt;dbl&gt;
##  1 Acerodo… Chir… Ptero… Acer… jubatus           0      0          0      1
##  2 Acinony… Carn… Felid… Acin… jubatus           1      0          0      0
##  3 Acratoc… Pilo… Megal… Acra… odontr…           1      0          0      0
##  4 Acratoc… Pilo… Megal… Acra… ye                1      0          0      0
##  5 Addax_n… Ceta… Bovid… Addax nasoma…           1      0          0      0
##  6 Aepycer… Ceta… Bovid… Aepy… melamp…           1      0          0      0
##  7 Aepypry… Dipr… Potor… Aepy… rufesc…           1      0          0      0
##  8 Aeromys… Rode… Sciur… Aero… tephro…           1      0          0      0
##  9 Aeromys… Rode… Sciur… Aero… thomasi           1      0          0      0
## 10 Agalmac… Ceta… Cervi… Agal… blicki            1      0          0      0
## # … with 1,116 more rows, and 15 more variables: life_habit_method &lt;chr&gt;,
## #   life_habit_source &lt;chr&gt;, mass_g &lt;dbl&gt;, mass_method &lt;chr&gt;,
## #   mass_source &lt;chr&gt;, mass_comparison &lt;chr&gt;, mass_comparison_source &lt;chr&gt;,
## #   island_endemicity &lt;chr&gt;, iucn_status &lt;chr&gt;, added_iucn_status &lt;chr&gt;,
## #   diet_plant &lt;dbl&gt;, diet_vertebrate &lt;dbl&gt;, diet_invertebrate &lt;dbl&gt;,
## #   diet_method &lt;chr&gt;, diet_source &lt;chr&gt;</code></pre>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb223-1" data-line-number="1">phylacine <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(mass_g <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">between</span>(<span class="fl">1e3</span>, <span class="fl">1e5</span>)) <span class="co"># dplyr</span></a></code></pre></div>
<pre><code>## # A tibble: 1,148 x 24
##    binomial order family genus species terrestrial marine freshwater aerial
##    &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;         &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt;  &lt;dbl&gt;
##  1 Acerodo… Chir… Ptero… Acer… jubatus           0      0          0      1
##  2 Acinony… Carn… Felid… Acin… jubatus           1      0          0      0
##  3 Acratoc… Pilo… Megal… Acra… odontr…           1      0          0      0
##  4 Acratoc… Pilo… Megal… Acra… ye                1      0          0      0
##  5 Addax_n… Ceta… Bovid… Addax nasoma…           1      0          0      0
##  6 Aepycer… Ceta… Bovid… Aepy… melamp…           1      0          0      0
##  7 Aepypry… Dipr… Potor… Aepy… rufesc…           1      0          0      0
##  8 Aeromys… Rode… Sciur… Aero… tephro…           1      0          0      0
##  9 Aeromys… Rode… Sciur… Aero… thomasi           1      0          0      0
## 10 Agalmac… Ceta… Cervi… Agal… blicki            1      0          0      0
## # … with 1,138 more rows, and 15 more variables: life_habit_method &lt;chr&gt;,
## #   life_habit_source &lt;chr&gt;, mass_g &lt;dbl&gt;, mass_method &lt;chr&gt;,
## #   mass_source &lt;chr&gt;, mass_comparison &lt;chr&gt;, mass_comparison_source &lt;chr&gt;,
## #   island_endemicity &lt;chr&gt;, iucn_status &lt;chr&gt;, added_iucn_status &lt;chr&gt;,
## #   diet_plant &lt;dbl&gt;, diet_vertebrate &lt;dbl&gt;, diet_invertebrate &lt;dbl&gt;,
## #   diet_method &lt;chr&gt;, diet_source &lt;chr&gt;</code></pre>
<p>If instead of selecting observations based on conditions, you want to get the nth row, use <code>slice()</code></p>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb225-1" data-line-number="1">phylacine <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">slice</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>)</a></code></pre></div>
<pre><code>## # A tibble: 3 x 24
##   binomial order family genus species terrestrial marine freshwater aerial
##   &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;         &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt;  &lt;dbl&gt;
## 1 Abditom… Rode… Murid… Abdi… latide…           1      0          0      0
## 2 Abeomel… Rode… Murid… Abeo… sevia             1      0          0      0
## 3 Abraway… Rode… Crice… Abra… ruschii           1      0          0      0
## # … with 15 more variables: life_habit_method &lt;chr&gt;, life_habit_source &lt;chr&gt;,
## #   mass_g &lt;dbl&gt;, mass_method &lt;chr&gt;, mass_source &lt;chr&gt;, mass_comparison &lt;chr&gt;,
## #   mass_comparison_source &lt;chr&gt;, island_endemicity &lt;chr&gt;, iucn_status &lt;chr&gt;,
## #   added_iucn_status &lt;chr&gt;, diet_plant &lt;dbl&gt;, diet_vertebrate &lt;dbl&gt;,
## #   diet_invertebrate &lt;dbl&gt;, diet_method &lt;chr&gt;, diet_source &lt;chr&gt;</code></pre>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb227-1" data-line-number="1"><span class="co"># can also be used to exclude rows</span></a>
<a class="sourceLine" id="cb227-2" data-line-number="2">phylacine <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb227-3" data-line-number="3"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">slice</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb227-4" data-line-number="4"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">slice</span>(<span class="op">-</span><span class="dv">2</span>) </a></code></pre></div>
<pre><code>## # A tibble: 2 x 24
##   binomial order family genus species terrestrial marine freshwater aerial
##   &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;         &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt;  &lt;dbl&gt;
## 1 Abditom… Rode… Murid… Abdi… latide…           1      0          0      0
## 2 Abraway… Rode… Crice… Abra… ruschii           1      0          0      0
## # … with 15 more variables: life_habit_method &lt;chr&gt;, life_habit_source &lt;chr&gt;,
## #   mass_g &lt;dbl&gt;, mass_method &lt;chr&gt;, mass_source &lt;chr&gt;, mass_comparison &lt;chr&gt;,
## #   mass_comparison_source &lt;chr&gt;, island_endemicity &lt;chr&gt;, iucn_status &lt;chr&gt;,
## #   added_iucn_status &lt;chr&gt;, diet_plant &lt;dbl&gt;, diet_vertebrate &lt;dbl&gt;,
## #   diet_invertebrate &lt;dbl&gt;, diet_method &lt;chr&gt;, diet_source &lt;chr&gt;</code></pre>
<p>You may also want the row number to be included as a variable, to be used as part of some condition or calculation. <code>tibble</code> is there for you:</p>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb229-1" data-line-number="1">phylacine <span class="op">%&gt;%</span><span class="st"> </span>tibble<span class="op">::</span><span class="kw">rownames_to_column</span>()</a></code></pre></div>
<pre><code>## # A tibble: 5,831 x 25
##    rowname binomial order family genus species terrestrial marine freshwater
##    &lt;chr&gt;   &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;         &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt;
##  1 1       Abditom… Rode… Murid… Abdi… latide…           1      0          0
##  2 2       Abeomel… Rode… Murid… Abeo… sevia             1      0          0
##  3 3       Abraway… Rode… Crice… Abra… ruschii           1      0          0
##  4 4       Abrocom… Rode… Abroc… Abro… bennet…           1      0          0
##  5 5       Abrocom… Rode… Abroc… Abro… bolivi…           1      0          0
##  6 6       Abrocom… Rode… Abroc… Abro… budini            1      0          0
##  7 7       Abrocom… Rode… Abroc… Abro… cinerea           1      0          0
##  8 8       Abrocom… Rode… Abroc… Abro… famati…           1      0          0
##  9 9       Abrocom… Rode… Abroc… Abro… shista…           1      0          0
## 10 10      Abrocom… Rode… Abroc… Abro… uspall…           1      0          0
## # … with 5,821 more rows, and 16 more variables: aerial &lt;dbl&gt;,
## #   life_habit_method &lt;chr&gt;, life_habit_source &lt;chr&gt;, mass_g &lt;dbl&gt;,
## #   mass_method &lt;chr&gt;, mass_source &lt;chr&gt;, mass_comparison &lt;chr&gt;,
## #   mass_comparison_source &lt;chr&gt;, island_endemicity &lt;chr&gt;, iucn_status &lt;chr&gt;,
## #   added_iucn_status &lt;chr&gt;, diet_plant &lt;dbl&gt;, diet_vertebrate &lt;dbl&gt;,
## #   diet_invertebrate &lt;dbl&gt;, diet_method &lt;chr&gt;, diet_source &lt;chr&gt;</code></pre>
</div>
<div id="create-new-variables-with-mutate" class="section level2">
<h2><span class="header-section-number">4.5</span> Create new variables with <code>mutate()</code></h2>
<p>can also edit existing ones</p>
<p>drop existing variables with <code>transmute()</code></p>
</div>
<div id="grouped-results-with-group_by-and-summarise" class="section level2">
<h2><span class="header-section-number">4.6</span> Grouped results with <code>group_by()</code> and <code>summarise()</code></h2>
</div>
<div id="scoped-variables" class="section level2">
<h2><span class="header-section-number">4.7</span> Scoped variables</h2>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb231-1" data-line-number="1"><span class="kw">data</span>(mtcars)</a>
<a class="sourceLine" id="cb231-2" data-line-number="2">mtcars <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select_all</span>(toupper)</a>
<a class="sourceLine" id="cb231-3" data-line-number="3"></a>
<a class="sourceLine" id="cb231-4" data-line-number="4">is_whole &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">all</span>(<span class="kw">floor</span>(x) <span class="op">==</span><span class="st"> </span>x)</a>
<a class="sourceLine" id="cb231-5" data-line-number="5">mtcars <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select_if</span>() <span class="co"># select integers only</span></a>
<a class="sourceLine" id="cb231-6" data-line-number="6"></a>
<a class="sourceLine" id="cb231-7" data-line-number="7">mtcars <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select_at</span>(<span class="kw">vars</span>(<span class="op">-</span><span class="kw">contains</span>(<span class="st">&quot;ar&quot;</span>)))</a>
<a class="sourceLine" id="cb231-8" data-line-number="8">mtcars <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select_at</span>(<span class="kw">vars</span>(<span class="op">-</span><span class="kw">contains</span>(<span class="st">&quot;ar&quot;</span>), <span class="kw">starts_with</span>(<span class="st">&quot;c&quot;</span>)))</a></code></pre></div>
</div>
<div id="more" class="section level2">
<h2><span class="header-section-number">4.8</span> More !</h2>
<p>dolla sign x point operator
variables values -&gt; dplyr::distinct() eq. to base::unique()
sample_n()
sample_frac()
first, last, nth</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="working-with-lists-and-iteration.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": "TRES-Tidy-Tutorial.pdf",
"toc": {
"collapse": "subsection",
"scroll_highlight": true
},
"toolbar": {
"position": "fixed"
},
"search": true
});
});
</script>

</body>

</html>
